<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Hive 分区表和分桶表 | Young&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="Young丶java后端技术博客,专注后端学习与总结。擅长spring boot,JAVA基础总结,等方面的知识,关注spring,架构,elasticsearch,mysql领域.">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.53c04193.css" as="style"><link rel="preload" href="/assets/js/app.e4caa6db.js" as="script"><link rel="preload" href="/assets/js/2.d1be14c5.js" as="script"><link rel="preload" href="/assets/js/52.d84cedc3.js" as="script"><link rel="prefetch" href="/assets/js/10.20449a2b.js"><link rel="prefetch" href="/assets/js/100.f25e73b5.js"><link rel="prefetch" href="/assets/js/101.3180ba9d.js"><link rel="prefetch" href="/assets/js/102.fcd415ea.js"><link rel="prefetch" href="/assets/js/103.522869bb.js"><link rel="prefetch" href="/assets/js/104.5da1e4e4.js"><link rel="prefetch" href="/assets/js/105.e5a40fe8.js"><link rel="prefetch" href="/assets/js/106.627d6279.js"><link rel="prefetch" href="/assets/js/107.606beca1.js"><link rel="prefetch" href="/assets/js/108.100e1cb2.js"><link rel="prefetch" href="/assets/js/109.9765392e.js"><link rel="prefetch" href="/assets/js/11.da3512b5.js"><link rel="prefetch" href="/assets/js/110.b73cf0d9.js"><link rel="prefetch" href="/assets/js/111.3f77dd60.js"><link rel="prefetch" href="/assets/js/112.0c7d547d.js"><link rel="prefetch" href="/assets/js/113.1827c266.js"><link rel="prefetch" href="/assets/js/114.daf1d8a5.js"><link rel="prefetch" href="/assets/js/115.e7dca24d.js"><link rel="prefetch" href="/assets/js/116.11b303de.js"><link rel="prefetch" href="/assets/js/117.203cefba.js"><link rel="prefetch" href="/assets/js/118.61d8527b.js"><link rel="prefetch" href="/assets/js/119.1f959a37.js"><link rel="prefetch" href="/assets/js/12.11f18e06.js"><link rel="prefetch" href="/assets/js/120.c268b7aa.js"><link rel="prefetch" href="/assets/js/121.64318c96.js"><link rel="prefetch" href="/assets/js/122.cbddb70d.js"><link rel="prefetch" href="/assets/js/123.b49b84fb.js"><link rel="prefetch" href="/assets/js/124.392f030b.js"><link rel="prefetch" href="/assets/js/125.45f631c4.js"><link rel="prefetch" href="/assets/js/126.700cc575.js"><link rel="prefetch" href="/assets/js/127.d649cb2a.js"><link rel="prefetch" href="/assets/js/128.bc018411.js"><link rel="prefetch" href="/assets/js/129.d0a74611.js"><link rel="prefetch" href="/assets/js/13.1cb33dc8.js"><link rel="prefetch" href="/assets/js/130.45b1f75c.js"><link rel="prefetch" href="/assets/js/131.45ba93df.js"><link rel="prefetch" href="/assets/js/132.c58bbbd7.js"><link rel="prefetch" href="/assets/js/133.7f53922e.js"><link rel="prefetch" href="/assets/js/134.ddf0d780.js"><link rel="prefetch" href="/assets/js/135.ada3af13.js"><link rel="prefetch" href="/assets/js/136.4097c2be.js"><link rel="prefetch" href="/assets/js/137.fc910ac9.js"><link rel="prefetch" href="/assets/js/138.9628f460.js"><link rel="prefetch" href="/assets/js/139.3125ef74.js"><link rel="prefetch" href="/assets/js/14.1004ce43.js"><link rel="prefetch" href="/assets/js/140.bb53ac81.js"><link rel="prefetch" href="/assets/js/141.a002ac19.js"><link rel="prefetch" href="/assets/js/142.540d19e4.js"><link rel="prefetch" href="/assets/js/143.4cbccfca.js"><link rel="prefetch" href="/assets/js/144.8a217b6a.js"><link rel="prefetch" href="/assets/js/145.9c7bc0de.js"><link rel="prefetch" href="/assets/js/146.3dfd0773.js"><link rel="prefetch" href="/assets/js/147.bc0f0d42.js"><link rel="prefetch" href="/assets/js/148.e0cdc4d5.js"><link rel="prefetch" href="/assets/js/149.8486db6e.js"><link rel="prefetch" href="/assets/js/15.703e8784.js"><link rel="prefetch" href="/assets/js/150.5f3b7fb5.js"><link rel="prefetch" href="/assets/js/151.98a3f202.js"><link rel="prefetch" href="/assets/js/152.2940f2ba.js"><link rel="prefetch" href="/assets/js/153.75f3a085.js"><link rel="prefetch" href="/assets/js/154.fa2da83b.js"><link rel="prefetch" href="/assets/js/155.113be5c8.js"><link rel="prefetch" href="/assets/js/156.0667e7f5.js"><link rel="prefetch" href="/assets/js/157.0b3e5dfa.js"><link rel="prefetch" href="/assets/js/158.a338bdd7.js"><link rel="prefetch" href="/assets/js/159.33c9771c.js"><link rel="prefetch" href="/assets/js/16.71e3d898.js"><link rel="prefetch" href="/assets/js/160.e868c8b3.js"><link rel="prefetch" href="/assets/js/161.cf61955e.js"><link rel="prefetch" href="/assets/js/162.baee00ca.js"><link rel="prefetch" href="/assets/js/163.183cde82.js"><link rel="prefetch" href="/assets/js/164.c1eadef5.js"><link rel="prefetch" href="/assets/js/165.70ee8a24.js"><link rel="prefetch" href="/assets/js/166.8e185ff2.js"><link rel="prefetch" href="/assets/js/167.0881cf57.js"><link rel="prefetch" href="/assets/js/168.88caf424.js"><link rel="prefetch" href="/assets/js/169.e7e984ff.js"><link rel="prefetch" href="/assets/js/17.b0356f05.js"><link rel="prefetch" href="/assets/js/170.c7052d81.js"><link rel="prefetch" href="/assets/js/171.2ab773fd.js"><link rel="prefetch" href="/assets/js/172.0e39f858.js"><link rel="prefetch" href="/assets/js/173.76661218.js"><link rel="prefetch" href="/assets/js/174.0ac9f795.js"><link rel="prefetch" href="/assets/js/175.da30bba2.js"><link rel="prefetch" href="/assets/js/176.0f230688.js"><link rel="prefetch" href="/assets/js/177.040e0937.js"><link rel="prefetch" href="/assets/js/178.68852030.js"><link rel="prefetch" href="/assets/js/179.c998f0ca.js"><link rel="prefetch" href="/assets/js/18.2e77c8d1.js"><link rel="prefetch" href="/assets/js/180.4f6b395f.js"><link rel="prefetch" href="/assets/js/181.577a5325.js"><link rel="prefetch" href="/assets/js/182.6b43cbf2.js"><link rel="prefetch" href="/assets/js/183.cf9e9cca.js"><link rel="prefetch" href="/assets/js/184.f0e76def.js"><link rel="prefetch" href="/assets/js/185.2d3d8eea.js"><link rel="prefetch" href="/assets/js/186.4db71601.js"><link rel="prefetch" href="/assets/js/187.8b6a6829.js"><link rel="prefetch" href="/assets/js/188.4a0b8f41.js"><link rel="prefetch" href="/assets/js/189.0a28241b.js"><link rel="prefetch" href="/assets/js/19.51c97d4c.js"><link rel="prefetch" href="/assets/js/190.5001309c.js"><link rel="prefetch" href="/assets/js/191.42778cf1.js"><link rel="prefetch" href="/assets/js/192.fabd1cb0.js"><link rel="prefetch" href="/assets/js/193.cbc113b8.js"><link rel="prefetch" href="/assets/js/194.4cf24763.js"><link rel="prefetch" href="/assets/js/195.ea5d1afb.js"><link rel="prefetch" href="/assets/js/196.16115ce4.js"><link rel="prefetch" href="/assets/js/197.b90179d1.js"><link rel="prefetch" href="/assets/js/198.456ceb51.js"><link rel="prefetch" href="/assets/js/199.a28de97a.js"><link rel="prefetch" href="/assets/js/20.79989fc4.js"><link rel="prefetch" href="/assets/js/200.72102ac7.js"><link rel="prefetch" href="/assets/js/201.e2b3a297.js"><link rel="prefetch" href="/assets/js/202.d4283e12.js"><link rel="prefetch" href="/assets/js/203.6e5e6596.js"><link rel="prefetch" href="/assets/js/204.363863cf.js"><link rel="prefetch" href="/assets/js/205.d16c5a36.js"><link rel="prefetch" href="/assets/js/206.dc867263.js"><link rel="prefetch" href="/assets/js/207.acfeaaaa.js"><link rel="prefetch" href="/assets/js/208.22c49054.js"><link rel="prefetch" href="/assets/js/209.0f7c526b.js"><link rel="prefetch" href="/assets/js/21.1b619a3f.js"><link rel="prefetch" href="/assets/js/210.b247a678.js"><link rel="prefetch" href="/assets/js/211.fe8629a4.js"><link rel="prefetch" href="/assets/js/212.48b672e5.js"><link rel="prefetch" href="/assets/js/213.08f571a8.js"><link rel="prefetch" href="/assets/js/214.04da1824.js"><link rel="prefetch" href="/assets/js/215.f60b57f4.js"><link rel="prefetch" href="/assets/js/216.4383ceb6.js"><link rel="prefetch" href="/assets/js/217.3b1ce286.js"><link rel="prefetch" href="/assets/js/218.1534ef52.js"><link rel="prefetch" href="/assets/js/219.6901e38c.js"><link rel="prefetch" href="/assets/js/22.349d3a16.js"><link rel="prefetch" href="/assets/js/220.22e0c5ea.js"><link rel="prefetch" href="/assets/js/221.2e7a5a4f.js"><link rel="prefetch" href="/assets/js/222.76b63073.js"><link rel="prefetch" href="/assets/js/223.500a058f.js"><link rel="prefetch" href="/assets/js/224.7f7c1250.js"><link rel="prefetch" href="/assets/js/225.2f183cbe.js"><link rel="prefetch" href="/assets/js/23.712dd5ac.js"><link rel="prefetch" href="/assets/js/24.77ae5052.js"><link rel="prefetch" href="/assets/js/25.e95f81fb.js"><link rel="prefetch" href="/assets/js/26.82cdd880.js"><link rel="prefetch" href="/assets/js/27.427a5aec.js"><link rel="prefetch" href="/assets/js/28.e245952d.js"><link rel="prefetch" href="/assets/js/29.50596e31.js"><link rel="prefetch" href="/assets/js/3.4f4335cf.js"><link rel="prefetch" href="/assets/js/30.016e73a0.js"><link rel="prefetch" href="/assets/js/31.fb0b0b40.js"><link rel="prefetch" href="/assets/js/32.8e7d8efe.js"><link rel="prefetch" href="/assets/js/33.f05f242b.js"><link rel="prefetch" href="/assets/js/34.893b8c3e.js"><link rel="prefetch" href="/assets/js/35.f98d31b7.js"><link rel="prefetch" href="/assets/js/36.6a5744a0.js"><link rel="prefetch" href="/assets/js/37.67e8976d.js"><link rel="prefetch" href="/assets/js/38.2d8447e0.js"><link rel="prefetch" href="/assets/js/39.3b3fde85.js"><link rel="prefetch" href="/assets/js/4.93e1dc89.js"><link rel="prefetch" href="/assets/js/40.8cde36eb.js"><link rel="prefetch" href="/assets/js/41.9df0f821.js"><link rel="prefetch" href="/assets/js/42.c9f1a26b.js"><link rel="prefetch" href="/assets/js/43.fa088c07.js"><link rel="prefetch" href="/assets/js/44.121055e3.js"><link rel="prefetch" href="/assets/js/45.7995c3a0.js"><link rel="prefetch" href="/assets/js/46.17d53a2e.js"><link rel="prefetch" href="/assets/js/47.4a374966.js"><link rel="prefetch" href="/assets/js/48.733e5b6c.js"><link rel="prefetch" href="/assets/js/49.0fb92742.js"><link rel="prefetch" href="/assets/js/5.f52855e6.js"><link rel="prefetch" href="/assets/js/50.50fc5031.js"><link rel="prefetch" href="/assets/js/51.69d8d52a.js"><link rel="prefetch" href="/assets/js/53.a64ddaf4.js"><link rel="prefetch" href="/assets/js/54.15e09103.js"><link rel="prefetch" href="/assets/js/55.0f7e8fd5.js"><link rel="prefetch" href="/assets/js/56.6cb5bf13.js"><link rel="prefetch" href="/assets/js/57.d90d9da6.js"><link rel="prefetch" href="/assets/js/58.2c03a905.js"><link rel="prefetch" href="/assets/js/59.02cf613a.js"><link rel="prefetch" href="/assets/js/6.0ff35647.js"><link rel="prefetch" href="/assets/js/60.bb6d2b2f.js"><link rel="prefetch" href="/assets/js/61.ef2abfd3.js"><link rel="prefetch" href="/assets/js/62.b09e5f81.js"><link rel="prefetch" href="/assets/js/63.6ca85ec7.js"><link rel="prefetch" href="/assets/js/64.77eab656.js"><link rel="prefetch" href="/assets/js/65.65b00883.js"><link rel="prefetch" href="/assets/js/66.040b5d23.js"><link rel="prefetch" href="/assets/js/67.23318ab1.js"><link rel="prefetch" href="/assets/js/68.5c29433f.js"><link rel="prefetch" href="/assets/js/69.90978695.js"><link rel="prefetch" href="/assets/js/7.463451e9.js"><link rel="prefetch" href="/assets/js/70.0c585fbd.js"><link rel="prefetch" href="/assets/js/71.120e4ae5.js"><link rel="prefetch" href="/assets/js/72.53bf1e3a.js"><link rel="prefetch" href="/assets/js/73.282f5b35.js"><link rel="prefetch" href="/assets/js/74.4f1cb67d.js"><link rel="prefetch" href="/assets/js/75.f5d3ea1e.js"><link rel="prefetch" href="/assets/js/76.fb173587.js"><link rel="prefetch" href="/assets/js/77.8064b022.js"><link rel="prefetch" href="/assets/js/78.d26f8075.js"><link rel="prefetch" href="/assets/js/79.6cff2fa5.js"><link rel="prefetch" href="/assets/js/8.d5f74857.js"><link rel="prefetch" href="/assets/js/80.29d746c7.js"><link rel="prefetch" href="/assets/js/81.c0a214a2.js"><link rel="prefetch" href="/assets/js/82.f0c93ca2.js"><link rel="prefetch" href="/assets/js/83.db6f55e1.js"><link rel="prefetch" href="/assets/js/84.b0a7a28c.js"><link rel="prefetch" href="/assets/js/85.db7376d4.js"><link rel="prefetch" href="/assets/js/86.96ec3402.js"><link rel="prefetch" href="/assets/js/87.ae41a109.js"><link rel="prefetch" href="/assets/js/88.d83c21c8.js"><link rel="prefetch" href="/assets/js/89.33868490.js"><link rel="prefetch" href="/assets/js/9.2680f96d.js"><link rel="prefetch" href="/assets/js/90.ed48459a.js"><link rel="prefetch" href="/assets/js/91.e1ee23ba.js"><link rel="prefetch" href="/assets/js/92.8b354527.js"><link rel="prefetch" href="/assets/js/93.0682d2e4.js"><link rel="prefetch" href="/assets/js/94.105580aa.js"><link rel="prefetch" href="/assets/js/95.d378d658.js"><link rel="prefetch" href="/assets/js/96.a6460598.js"><link rel="prefetch" href="/assets/js/97.a4cc955f.js"><link rel="prefetch" href="/assets/js/98.9a600d4f.js"><link rel="prefetch" href="/assets/js/99.45007523.js">
    <link rel="stylesheet" href="/assets/css/0.styles.53c04193.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="Young's blog" class="logo"> <span class="site-name can-hide">Young's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/Spring/" class="nav-link">Spring</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端文章1</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/8143cc480faf9a11/" class="nav-link">JavaScript</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/javascript/" class="nav-link">《JavaScript教程》</a></li><li class="dropdown-subitem"><a href="/note/js/" class="nav-link">《JavaScript高级程序设计》</a></li><li class="dropdown-subitem"><a href="/note/es6/" class="nav-link">《ES6 教程》</a></li><li class="dropdown-subitem"><a href="/note/vue/" class="nav-link">《Vue》</a></li><li class="dropdown-subitem"><a href="/note/react/" class="nav-link">《React》</a></li><li class="dropdown-subitem"><a href="/note/typescript-axios/" class="nav-link">《TypeScript 从零实现 axios》</a></li><li class="dropdown-subitem"><a href="/note/git/" class="nav-link">《Git》</a></li><li class="dropdown-subitem"><a href="/pages/51afd6/" class="nav-link">TypeScript</a></li><li class="dropdown-subitem"><a href="/pages/4643cd/" class="nav-link">JS设计模式总结</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="页面" class="dropdown-title"><a href="/ui/" class="link-title">页面</a> <span class="title" style="display:none;">页面</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/8309a5b876fc95e3/" class="nav-link">HTML</a></li><li class="dropdown-item"><!----> <a href="/pages/0a83b083bdf257cb/" class="nav-link">CSS</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/technology/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/9a7ee40fc232253e/" class="nav-link">技术文档</a></li><li class="dropdown-item"><!----> <a href="/pages/4c778760be26d8b3/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/pages/117708e0af7f0bd9/" class="nav-link">Nodejs</a></li><li class="dropdown-item"><!----> <a href="/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/pages/aea6571b7a8bae86/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/andanyang/vuepress-theme-vdoing" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/logo.png"> <div class="blogger-info"><h3>Young</h3> <span></span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/Spring/" class="nav-link">Spring</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端文章1</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/8143cc480faf9a11/" class="nav-link">JavaScript</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/javascript/" class="nav-link">《JavaScript教程》</a></li><li class="dropdown-subitem"><a href="/note/js/" class="nav-link">《JavaScript高级程序设计》</a></li><li class="dropdown-subitem"><a href="/note/es6/" class="nav-link">《ES6 教程》</a></li><li class="dropdown-subitem"><a href="/note/vue/" class="nav-link">《Vue》</a></li><li class="dropdown-subitem"><a href="/note/react/" class="nav-link">《React》</a></li><li class="dropdown-subitem"><a href="/note/typescript-axios/" class="nav-link">《TypeScript 从零实现 axios》</a></li><li class="dropdown-subitem"><a href="/note/git/" class="nav-link">《Git》</a></li><li class="dropdown-subitem"><a href="/pages/51afd6/" class="nav-link">TypeScript</a></li><li class="dropdown-subitem"><a href="/pages/4643cd/" class="nav-link">JS设计模式总结</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="页面" class="dropdown-title"><a href="/ui/" class="link-title">页面</a> <span class="title" style="display:none;">页面</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/8309a5b876fc95e3/" class="nav-link">HTML</a></li><li class="dropdown-item"><!----> <a href="/pages/0a83b083bdf257cb/" class="nav-link">CSS</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/technology/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/9a7ee40fc232253e/" class="nav-link">技术文档</a></li><li class="dropdown-item"><!----> <a href="/pages/4c778760be26d8b3/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/pages/117708e0af7f0bd9/" class="nav-link">Nodejs</a></li><li class="dropdown-item"><!----> <a href="/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/pages/aea6571b7a8bae86/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/andanyang/vuepress-theme-vdoing" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Hadoop</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>kafka</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Flume</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>hive</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/hive_Basic/" class="sidebar-link">Hive入门</a></li><li><a href="/bigdata/hive_sql/" class="sidebar-link">Hive sql</a></li><li><a href="/bigdata/hive_Partition_Bucket/" aria-current="page" class="active sidebar-link">Hive 分区表和分桶表</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/bigdata/hive_Partition_Bucket/#_10-1-分区表" class="sidebar-link">10.1 分区表</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/bigdata/hive_Partition_Bucket/#_10-1-1-分区表基本语法" class="sidebar-link">10.1.1 分区表基本语法</a></li><li class="sidebar-sub-header level4"><a href="/bigdata/hive_Partition_Bucket/#_1-创建分区表" class="sidebar-link">1. 创建分区表</a></li><li class="sidebar-sub-header level4"><a href="/bigdata/hive_Partition_Bucket/#_2-分区表读写数据" class="sidebar-link">2. 分区表读写数据</a></li><li class="sidebar-sub-header level5"><a href="/bigdata/hive_Partition_Bucket/#_1-写数据" class="sidebar-link">1）写数据</a></li><li class="sidebar-sub-header level5"><a href="/bigdata/hive_Partition_Bucket/#_2-读数据" class="sidebar-link">2）读数据</a></li><li class="sidebar-sub-header level5"><a href="/bigdata/hive_Partition_Bucket/#_3-分区表存储" class="sidebar-link">3）分区表存储</a></li><li class="sidebar-sub-header level4"><a href="/bigdata/hive_Partition_Bucket/#_3-分区表基本操作" class="sidebar-link">3. 分区表基本操作</a></li><li class="sidebar-sub-header level5"><a href="/bigdata/hive_Partition_Bucket/#_1-查看所有分区信息" class="sidebar-link">1）查看所有分区信息</a></li><li class="sidebar-sub-header level5"><a href="/bigdata/hive_Partition_Bucket/#_2-增加分区" class="sidebar-link">2）增加分区</a></li><li class="sidebar-sub-header level5"><a href="/bigdata/hive_Partition_Bucket/#_3-删除分区" class="sidebar-link">3）删除分区</a></li><li class="sidebar-sub-header level5"><a href="/bigdata/hive_Partition_Bucket/#_4-修复分区" class="sidebar-link">4）修复分区</a></li><li class="sidebar-sub-header level5"><a href="/bigdata/hive_Partition_Bucket/#_1-add-partition" class="sidebar-link">（1）add partition</a></li><li class="sidebar-sub-header level5"><a href="/bigdata/hive_Partition_Bucket/#_2-drop-partition" class="sidebar-link">（2）drop partition</a></li><li class="sidebar-sub-header level5"><a href="/bigdata/hive_Partition_Bucket/#_3-msck" class="sidebar-link">（3）msck</a></li><li class="sidebar-sub-header level3"><a href="/bigdata/hive_Partition_Bucket/#_10-1-2-二级分区表" class="sidebar-link">10.1.2 二级分区表</a></li><li class="sidebar-sub-header level4"><a href="/bigdata/hive_Partition_Bucket/#_1-二级分区表建表语句" class="sidebar-link">1）二级分区表建表语句</a></li><li class="sidebar-sub-header level4"><a href="/bigdata/hive_Partition_Bucket/#_2-数据装载语句" class="sidebar-link">2）数据装载语句</a></li><li class="sidebar-sub-header level3"><a href="/bigdata/hive_Partition_Bucket/#_10-1-3-动态分区" class="sidebar-link">10.1.3 动态分区</a></li><li class="sidebar-sub-header level4"><a href="/bigdata/hive_Partition_Bucket/#_1-动态分区相关参数" class="sidebar-link">1）动态分区相关参数</a></li><li class="sidebar-sub-header level4"><a href="/bigdata/hive_Partition_Bucket/#_2-案例实操" class="sidebar-link">2）案例实操</a></li><li class="sidebar-sub-header level3"><a href="/bigdata/hive_Partition_Bucket/#_10-2-分桶表" class="sidebar-link">10.2 分桶表</a></li><li class="sidebar-sub-header level3"><a href="/bigdata/hive_Partition_Bucket/#_10-2-1-分桶表基本语法" class="sidebar-link">10.2.1 分桶表基本语法</a></li><li class="sidebar-sub-header level4"><a href="/bigdata/hive_Partition_Bucket/#_1-建表语句" class="sidebar-link">1）建表语句</a></li><li class="sidebar-sub-header level4"><a href="/bigdata/hive_Partition_Bucket/#_2-数据装载" class="sidebar-link">2）数据装载</a></li><li class="sidebar-sub-header level3"><a href="/bigdata/hive_Partition_Bucket/#_10-2-2-分桶排序表" class="sidebar-link">10.2.2 分桶排序表</a></li><li class="sidebar-sub-header level4"><a href="/bigdata/hive_Partition_Bucket/#_1-建表语句-2" class="sidebar-link">1）建表语句</a></li><li class="sidebar-sub-header level4"><a href="/bigdata/hive_Partition_Bucket/#_2-数据装载-2" class="sidebar-link">2）数据装载</a></li></ul></li></ul></li><li><a href="/bigdata/hive_File_format_compressiont/" class="sidebar-link">Hive 件格式和压缩</a></li><li><a href="/bigdata/hive_Performance_Tune/" class="sidebar-link">Hive 调优</a></li><li><a href="/bigdata/hive_trap/" class="sidebar-link">Hive入门 的坑</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>scala</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>spark</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/categories/?category=%E5%A4%A7%E6%95%B0%E6%8D%AE" title="分类" data-v-06225672>大数据</a></li><li data-v-06225672><a href="/categories/?category=hive" title="分类" data-v-06225672>hive</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/andanyoung" target="_blank" title="作者" class="beLink" data-v-06225672>andanyang</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2023-10-16</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">Hive 分区表和分桶表<!----></h1>  <div class="theme-vdoing-content content__default"><h1 id="第10章-分区表和分桶表"><a href="#第10章-分区表和分桶表" class="header-anchor">#</a> 第10章 分区表和分桶表</h1> <h2 id="_10-1-分区表"><a href="#_10-1-分区表" class="header-anchor">#</a> 10.1 分区表</h2> <p>Hive中的分区就是把一张大表的数据按照业务需要分散的存储到多个目录，每个目录就称为该表的一个分区。在查询时通过where子句中的表达式选择查询所需要的分区，这样的查询效率会提高很多。</p> <blockquote><p>分到不同的路径下</p></blockquote> <h3 id="_10-1-1-分区表基本语法"><a href="#_10-1-1-分区表基本语法" class="header-anchor">#</a> 10.1.1 分区表基本语法</h3> <h4 id="_1-创建分区表"><a href="#_1-创建分区表" class="header-anchor">#</a> 1. 创建分区表</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>hive (default)&gt; 
create table dept_partition
(
    deptno int,    --部门编号
    dname  string, --部门名称
    loc    string  --部门位置
)
    partitioned by (day string)
    row format delimited fields terminated by '\t';
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="_2-分区表读写数据"><a href="#_2-分区表读写数据" class="header-anchor">#</a> 2. 分区表读写数据</h4> <h5 id="_1-写数据"><a href="#_1-写数据" class="header-anchor">#</a> 1）写数据</h5> <p>（1）load
数据准备</p> <p>在/opt/module/hive/datas/路径上创建文件dept_20220401.log，并输入如下内容。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[atguigu@hadoop102 datas]$ vim dept_20220401.log
10	行政部	1700
20	财务部	1800
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>装载语句</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>hive (default)&gt; 
load data local inpath '/opt/module/hive/datas/dept_20220401.log' 
into table dept_partition 
partition(day='20220401');
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><img src="data:image/png;base64,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" alt="image-20231017230131857"></p> <p>（2）insert</p> <p>将day='20220401'分区的数据插入到day='20220402'分区，可执行如下装载语句</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>hive (default)&gt; 
insert overwrite table dept_partition partition (day = '20220402')
select deptno, dname, loc
from dept_partition
where day = '20220401';
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h5 id="_2-读数据"><a href="#_2-读数据" class="header-anchor">#</a> 2）读数据</h5> <p>查询分区表数据时，可以将分区字段看作表的<strong>伪列</strong>，可像使用其他字段一样使用分区字段。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select deptno, dname, loc ,day
from dept_partition
where day = '2020-04-01';
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><img src="/assets/img/image-20231024231631599.883e11e9.png" alt="image-20231024231631599"></p> <h5 id="_3-分区表存储"><a href="#_3-分区表存储" class="header-anchor">#</a> 3）分区表存储</h5> <p><img src="/assets/img/image-20231024231617490.5279484f.png" alt="image-20231024231617490"></p> <h4 id="_3-分区表基本操作"><a href="#_3-分区表基本操作" class="header-anchor">#</a> 3. 分区表基本操作</h4> <h5 id="_1-查看所有分区信息"><a href="#_1-查看所有分区信息" class="header-anchor">#</a> 1）查看所有分区信息</h5> <div class="language- line-numbers-mode"><pre class="language-text"><code>hive&gt; show partitions dept_partition;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h5 id="_2-增加分区"><a href="#_2-增加分区" class="header-anchor">#</a> 2）增加分区</h5> <p>（1）创建单个分区</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>hive (default)&gt; 
alter table dept_partition 
add partition(day='20220403');
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>（2）同时创建多个分区（分区之间不能有逗号）</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>hive (default)&gt; 
alter table dept_partition 
add partition(day='20220404') partition(day='20220405');
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><img src="/assets/img/image-20231024231943089.cab11585.png" alt="image-20231024231943089"></p> <ul><li>在HDFS 添加一个空目录</li> <li>在元数据添加分区信息</li></ul> <h5 id="_3-删除分区"><a href="#_3-删除分区" class="header-anchor">#</a> 3）删除分区</h5> <p>（1）删除单个分区</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>hive (default)&gt; 
alter table dept_partition 
drop partition (day='20220403');
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>（2）同时删除多个分区（分区之间必须有逗号）</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>hive (default)&gt; 
alter table dept_partition 
drop partition (day='20220404'), partition(day='20220405');
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h5 id="_4-修复分区"><a href="#_4-修复分区" class="header-anchor">#</a> 4）修复分区</h5> <p>Hive将分区表的所有分区信<strong>息都保存在了元数据中</strong>，只有元数据与HDFS上的分区路径一致时，分区表才能正常读写数据。若用户手动创建/删除分区路径，Hive都是感知不到的，这样就会导致Hive的元数据和HDFS的分区路径不一致。再比如，若分区表为外部表，用户执行drop partition命令后，分区元数据会被删除，而HDFS的分区路径不会被删除，同样会导致Hive的元数据和HDFS的分区路径不一致。
若出现元数据和HDFS路径不一致的情况，可通过如下几种手段进行修复。</p> <h5 id="_1-add-partition"><a href="#_1-add-partition" class="header-anchor">#</a> （1）add partition</h5> <p>若手动创建HDFS的分区路径，Hive无法识别，可通过add partition命令增加分区元数据信息，从而使元数据和分区路径保持一致。</p> <h5 id="_2-drop-partition"><a href="#_2-drop-partition" class="header-anchor">#</a> （2）drop partition</h5> <p>若手动删除HDFS的分区路径，Hive无法识别，可通过drop partition命令删除分区元数据信息，从而使元数据和分区路径保持一致。</p> <h5 id="_3-msck"><a href="#_3-msck" class="header-anchor">#</a> （3）msck</h5> <p>若分区元数据和HDFS的分区路径不一致，还可使用msck命令进行修复，以下是该命令的用法说明。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>hive (default)&gt; 
msck repair table table_name [add/drop/sync partitions];
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>说明：</p> <ul><li><code>msck repair table table_name add partitions</code>：该命令会增加HDFS路径存在但元数据缺失的分区信息。</li> <li><code>msck repair table table_name drop partitions</code>：该命令会删除HDFS路径已经删除但元数据仍然存在的分区信息。</li> <li><code>msck repair table table_name sync partitions</code>：该命令会同步HDFS路径和元数据分区信息，相当于同时执行上述的两个命令。</li> <li><code>msck repair table table_name</code>：等价于msck repair table table_name add partitions命令。</li></ul> <h3 id="_10-1-2-二级分区表"><a href="#_10-1-2-二级分区表" class="header-anchor">#</a> 10.1.2 二级分区表</h3> <p>思考：如果一天内的日志数据量也很大，如何再将数据拆分?答案是二级分区表，例如可以在按天分区的基础上，再对每天的数据按小时进行分区。</p> <h4 id="_1-二级分区表建表语句"><a href="#_1-二级分区表建表语句" class="header-anchor">#</a> 1）二级分区表建表语句</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>hive (default)&gt;
create table dept_partition2(
    deptno int,    -- 部门编号
    dname string, -- 部门名称
    loc string     -- 部门位置
)
partitioned by (day string, hour string)
row format delimited fields terminated by '\t';
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="_2-数据装载语句"><a href="#_2-数据装载语句" class="header-anchor">#</a> 2）数据装载语句</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>hive (default)&gt; 
load data local inpath '/opt/module/hive/datas/dept_20220401.log' 
into table dept_partition2 
partition(day='20220401', hour='12');
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>3）查询分区数据</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>hive (default)&gt; 
select 
    * 
from dept_partition2 
where day='20220401' and hour='12';
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><img src="/assets/img/image-20231024233051448.80452965.png" alt="image-20231024233051448"></p> <p><img src="/assets/img/image-20231024233108820.c173dd2e.png" alt="image-20231024233108820"></p> <h3 id="_10-1-3-动态分区"><a href="#_10-1-3-动态分区" class="header-anchor">#</a> 10.1.3 动态分区</h3> <p>动态分区是指向分区表insert数据时，被写往的分区不由用户指定，而是由每行数据的最后一个字段的值来动态的决定。使用动态分区，可只用一个insert语句将数据写入多个分区。</p> <h4 id="_1-动态分区相关参数"><a href="#_1-动态分区相关参数" class="header-anchor">#</a> 1）动态分区相关参数</h4> <p>（1）动态分区功能总开关（默认true，开启）</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>set hive.exec.dynamic.partition=true
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>（2）严格模式和非严格模式</p> <p>动态分区的模式，默认strict（严格模式），要求必须指定至少一个分区为静态分区（多级分区），nonstrict（非严格模式）允许所有的分区字段都使用动态分区。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>set hive.exec.dynamic.partition.mode=nonstrict
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>（3）一条insert语句可同时创建的最大的分区个数，默认为1000。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>set hive.exec.max.dynamic.partitions=1000
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>（4）单个Mapper或者Reducer可同时创建的最大的分区个数，默认为100。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>set hive.exec.max.dynamic.partitions.pernode=100
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>（5）一条insert语句可以创建的最大的文件个数，默认100000。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>hive.exec.max.created.files=100000
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>（6）当查询结果为空时且进行动态分区时，是否抛出异常，默认false。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>hive.error.on.empty.partition=false
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="_2-案例实操"><a href="#_2-案例实操" class="header-anchor">#</a> 2）案例实操</h4> <p>需求：将dept表中的数据按照地区（loc字段），插入到目标表dept_partition_dynamic的相应分区中。</p> <p>（1）创建目标分区表</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>hive (default)&gt; 
create table dept_partition_dynamic(
    id int, 
    name string
) 
partitioned by (loc int) 
row format delimited fields terminated by '\t';
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>（2）设置动态分区</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>set hive.exec.dynamic.partition.mode = nonstrict;
hive (default)&gt; 
insert into table dept_partition_dynamic 
partition(loc) 
select 
    deptno, 
    dname, 
    loc 
from dept;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>（3）查看目标分区表的分区情况</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>hive (default)&gt; show partitions dept_partition_dynamic;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/assets/img/image-20231024234259008.016401b3.png" alt="image-20231024234259008"></p> <h3 id="_10-2-分桶表"><a href="#_10-2-分桶表" class="header-anchor">#</a> 10.2 分桶表</h3> <p>分区提供一个隔离数据和优化查询的便利方式。不过，并非所有的数据集都可形成合理的分区。对于一张表或者分区，Hive 可以进一步组织成桶，也就是更为细粒度的数据范围划分，<strong>分区针对的是数据的存储路径，分桶针对的是数据文件。</strong>
分桶表的基本原理是，首先为每行数据计算一个指定字段的数据的hash值，然后模以一个指定的分桶数，最后将取模运算结果相同的行，写入同一个文件中，这个文件就称为一个分桶（bucket）。</p> <blockquote><p>分桶，分到同个路径下不同文件 分区分到不同路径目录下</p> <p>分桶和分区可以配合使用，但不可以取同个字段，因为没意义，key分桶的都会分到同个桶中</p></blockquote> <h3 id="_10-2-1-分桶表基本语法"><a href="#_10-2-1-分桶表基本语法" class="header-anchor">#</a> 10.2.1 分桶表基本语法</h3> <h4 id="_1-建表语句"><a href="#_1-建表语句" class="header-anchor">#</a> 1）建表语句</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>hive (default)&gt; 
create table stu_buck(
    id int, 
    name string
)
clustered by(id) 
into 4 buckets
row format delimited fields terminated by '\t';
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="_2-数据装载"><a href="#_2-数据装载" class="header-anchor">#</a> 2）数据装载</h4> <p>（1）数据准备</p> <p>在/opt/module/hive/datas/路径上创建student.txt文件，并输入如下内容。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>1001	student1
1002	student2
1003	student3
1004	student4
1005	student5
1006	student6
1007	student7
1008	student8
1009	student9
1010	student10
1011	student11
1012	student12
1013	student13
1014	student14
1015	student15
1016	student16
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>（2）导入数据到分桶表中</p> <blockquote><p>说明：Hive新版本load数据可以直接跑MapReduce，老版的Hive需要将数据传到一张表里，再通过查询的方式导入到分桶表里面。</p></blockquote> <div class="language- line-numbers-mode"><pre class="language-text"><code>hive (default)&gt; 
load data local inpath '/opt/module/hive/datas/student.txt' 
into table stu_buck;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>（3）查看创建的分桶表中是否分成4个桶（hive 3.x load增强,会分桶）</p> <p><img src="/assets/img/image-20231017225212644.56d03e38.png" alt="分桶表中是否分成4个桶"></p> <p>（4）观察每个分桶中的数据</p> <h3 id="_10-2-2-分桶排序表"><a href="#_10-2-2-分桶排序表" class="header-anchor">#</a> 10.2.2 分桶排序表</h3> <blockquote><p>对每个分桶进行排序</p></blockquote> <h4 id="_1-建表语句-2"><a href="#_1-建表语句-2" class="header-anchor">#</a> 1）建表语句</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>hive (default)&gt; 
create table stu_buck_sort(
    id int, 
    name string
)
clustered by(id) sorted by(id)
into 4 buckets
row format delimited fields terminated by '\t';
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="_2-数据装载-2"><a href="#_2-数据装载-2" class="header-anchor">#</a> 2）数据装载</h4> <p>（1）导入数据到分桶表中</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>hive (default)&gt; 
load data local inpath '/opt/module/hive/datas/student.txt' 
into table stu_buck_sort;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>（2）查看创建的分桶表中是否分成4个桶</p> <p><img src="/assets/img/image-20231017225333471.5a8722f2.png" alt="image-20231017225333471"></p> <p>3）观察每个分桶中的数据</p></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/andanyang/vuepress-theme-vdoing/edit/master/docs/大数据/004.hive/003.Hive 分区表和分桶表.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2024/03/11, 02:40:47</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/bigdata/hive_sql/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">Hive sql</div></a> <a href="/bigdata/hive_File_format_compressiont/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">Hive 件格式和压缩</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/bigdata/hive_sql/" class="prev">Hive sql</a></span> <span class="next"><a href="/bigdata/hive_File_format_compressiont/">Hive 件格式和压缩</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/bigdata/spark/SparkStreaming_Driver_Executer/"><div>
            spark中代码的执行位置（Driver or Executer）
            <!----></div></a> <span class="date">12-12</span></dt></dl><dl><dd>02</dd> <dt><a href="/bigdata/spark/SparkStreaming/"><div>
            大数据技术之 SparkStreaming
            <!----></div></a> <span class="date">12-12</span></dt></dl><dl><dd>03</dd> <dt><a href="/bigdata/spark/sql/"><div>
            Spark 核心编程之 RDD 累加器与广播变量
            <!----></div></a> <span class="date">12-06</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:1218853253@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/andanyang" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=755597173" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2019-2024
    <span>Young | <a href="https://github.com/andanyoung/young-blog/blob/master/LICENSE" target="_blank">MIT License</a> <br/> <a  href="https://beian.miit.gov.cn/" target="_blank">浙ICP备20002744号</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.e4caa6db.js" defer></script><script src="/assets/js/2.d1be14c5.js" defer></script><script src="/assets/js/52.d84cedc3.js" defer></script>
  </body>
</html>
