<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Untitled | Young&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="Young丶java后端技术博客,专注后端学习与总结。擅长spring boot,JAVA基础总结,等方面的知识,关注spring,架构,elasticsearch,mysql领域.">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.d9c8cf8c.css" as="style"><link rel="preload" href="/assets/js/app.abbd16b8.js" as="script"><link rel="preload" href="/assets/js/2.dfbf9bb4.js" as="script"><link rel="preload" href="/assets/js/45.aabd696d.js" as="script"><link rel="prefetch" href="/assets/js/10.47f856a2.js"><link rel="prefetch" href="/assets/js/11.c545e317.js"><link rel="prefetch" href="/assets/js/12.8f1e71e8.js"><link rel="prefetch" href="/assets/js/13.25320c0a.js"><link rel="prefetch" href="/assets/js/14.2b29f74e.js"><link rel="prefetch" href="/assets/js/15.3924a2a6.js"><link rel="prefetch" href="/assets/js/16.5d8b50da.js"><link rel="prefetch" href="/assets/js/17.f3e05c73.js"><link rel="prefetch" href="/assets/js/18.e7618235.js"><link rel="prefetch" href="/assets/js/19.1fc48afc.js"><link rel="prefetch" href="/assets/js/20.b7ffed02.js"><link rel="prefetch" href="/assets/js/21.bb49f180.js"><link rel="prefetch" href="/assets/js/22.803282db.js"><link rel="prefetch" href="/assets/js/23.8251955c.js"><link rel="prefetch" href="/assets/js/24.a9d24a4b.js"><link rel="prefetch" href="/assets/js/25.0b055ca1.js"><link rel="prefetch" href="/assets/js/26.de7d3eff.js"><link rel="prefetch" href="/assets/js/27.f548e18d.js"><link rel="prefetch" href="/assets/js/28.fb07dd9b.js"><link rel="prefetch" href="/assets/js/29.edd63df9.js"><link rel="prefetch" href="/assets/js/3.8d9bb125.js"><link rel="prefetch" href="/assets/js/30.81eb5a35.js"><link rel="prefetch" href="/assets/js/31.18992713.js"><link rel="prefetch" href="/assets/js/32.989a5e0b.js"><link rel="prefetch" href="/assets/js/33.e7014b95.js"><link rel="prefetch" href="/assets/js/34.e2425ad8.js"><link rel="prefetch" href="/assets/js/35.dad633dc.js"><link rel="prefetch" href="/assets/js/36.09e173d1.js"><link rel="prefetch" href="/assets/js/37.f845d42e.js"><link rel="prefetch" href="/assets/js/38.b0f47ce8.js"><link rel="prefetch" href="/assets/js/39.0c226ca7.js"><link rel="prefetch" href="/assets/js/4.a06ed5a6.js"><link rel="prefetch" href="/assets/js/40.ef555a3e.js"><link rel="prefetch" href="/assets/js/41.0f920f6b.js"><link rel="prefetch" href="/assets/js/42.ce33c87e.js"><link rel="prefetch" href="/assets/js/43.e5f8f9d6.js"><link rel="prefetch" href="/assets/js/44.a38970d2.js"><link rel="prefetch" href="/assets/js/46.0c09d4cf.js"><link rel="prefetch" href="/assets/js/47.19663bcd.js"><link rel="prefetch" href="/assets/js/48.6c117e2f.js"><link rel="prefetch" href="/assets/js/49.70d7b2a2.js"><link rel="prefetch" href="/assets/js/5.49576e2a.js"><link rel="prefetch" href="/assets/js/50.40895b43.js"><link rel="prefetch" href="/assets/js/51.87c64343.js"><link rel="prefetch" href="/assets/js/52.c85a2a91.js"><link rel="prefetch" href="/assets/js/53.cd9d1efc.js"><link rel="prefetch" href="/assets/js/54.954629b4.js"><link rel="prefetch" href="/assets/js/55.29116d2f.js"><link rel="prefetch" href="/assets/js/56.e5e33eae.js"><link rel="prefetch" href="/assets/js/57.d3310e45.js"><link rel="prefetch" href="/assets/js/58.eaf4d908.js"><link rel="prefetch" href="/assets/js/59.e9db2735.js"><link rel="prefetch" href="/assets/js/6.be84d553.js"><link rel="prefetch" href="/assets/js/60.1f196998.js"><link rel="prefetch" href="/assets/js/61.926a7275.js"><link rel="prefetch" href="/assets/js/62.8af3a662.js"><link rel="prefetch" href="/assets/js/63.e0f86830.js"><link rel="prefetch" href="/assets/js/64.47570781.js"><link rel="prefetch" href="/assets/js/65.09964d7f.js"><link rel="prefetch" href="/assets/js/66.4bbbeb6c.js"><link rel="prefetch" href="/assets/js/67.6eff21f1.js"><link rel="prefetch" href="/assets/js/68.e271f03a.js"><link rel="prefetch" href="/assets/js/69.67a9c142.js"><link rel="prefetch" href="/assets/js/7.38fa7306.js"><link rel="prefetch" href="/assets/js/70.7c816b68.js"><link rel="prefetch" href="/assets/js/71.5518cd5f.js"><link rel="prefetch" href="/assets/js/72.2284e8e3.js"><link rel="prefetch" href="/assets/js/73.a54b4232.js"><link rel="prefetch" href="/assets/js/74.f6482146.js"><link rel="prefetch" href="/assets/js/75.231e1522.js"><link rel="prefetch" href="/assets/js/76.3ca1e095.js"><link rel="prefetch" href="/assets/js/77.f05d4d11.js"><link rel="prefetch" href="/assets/js/78.d8c8b878.js"><link rel="prefetch" href="/assets/js/79.2903ffdf.js"><link rel="prefetch" href="/assets/js/8.5d46e0f8.js"><link rel="prefetch" href="/assets/js/80.1a316b20.js"><link rel="prefetch" href="/assets/js/81.1b5a7542.js"><link rel="prefetch" href="/assets/js/82.4f211c50.js"><link rel="prefetch" href="/assets/js/83.5c8d0c71.js"><link rel="prefetch" href="/assets/js/84.8bc601e4.js"><link rel="prefetch" href="/assets/js/85.474f5b80.js"><link rel="prefetch" href="/assets/js/86.d29c6514.js"><link rel="prefetch" href="/assets/js/87.333e921d.js"><link rel="prefetch" href="/assets/js/88.3b4c21bb.js"><link rel="prefetch" href="/assets/js/89.692757d4.js"><link rel="prefetch" href="/assets/js/9.021837e6.js"><link rel="prefetch" href="/assets/js/90.2c1c769d.js"><link rel="prefetch" href="/assets/js/91.69346b88.js"><link rel="prefetch" href="/assets/js/92.b296cac4.js"><link rel="prefetch" href="/assets/js/93.5325ee60.js"><link rel="prefetch" href="/assets/js/94.24ece75f.js"><link rel="prefetch" href="/assets/js/95.4a01d0e7.js"><link rel="prefetch" href="/assets/js/96.f0273d69.js"><link rel="prefetch" href="/assets/js/97.10ec3023.js"><link rel="prefetch" href="/assets/js/98.5dc83689.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d9c8cf8c.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="Young's blog" class="logo"> <span class="site-name can-hide">Young's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/Spring/" class="nav-link">Spring</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端文章1</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/8143cc480faf9a11/" class="nav-link">JavaScript</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/javascript/" class="nav-link">《JavaScript教程》</a></li><li class="dropdown-subitem"><a href="/note/js/" class="nav-link">《JavaScript高级程序设计》</a></li><li class="dropdown-subitem"><a href="/note/es6/" class="nav-link">《ES6 教程》</a></li><li class="dropdown-subitem"><a href="/note/vue/" class="nav-link">《Vue》</a></li><li class="dropdown-subitem"><a href="/note/react/" class="nav-link">《React》</a></li><li class="dropdown-subitem"><a href="/note/typescript-axios/" class="nav-link">《TypeScript 从零实现 axios》</a></li><li class="dropdown-subitem"><a href="/note/git/" class="nav-link">《Git》</a></li><li class="dropdown-subitem"><a href="/pages/51afd6/" class="nav-link">TypeScript</a></li><li class="dropdown-subitem"><a href="/pages/4643cd/" class="nav-link">JS设计模式总结</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="页面" class="dropdown-title"><a href="/ui/" class="link-title">页面</a> <span class="title" style="display:none;">页面</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/8309a5b876fc95e3/" class="nav-link">HTML</a></li><li class="dropdown-item"><!----> <a href="/pages/0a83b083bdf257cb/" class="nav-link">CSS</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/technology/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/9a7ee40fc232253e/" class="nav-link">技术文档</a></li><li class="dropdown-item"><!----> <a href="/pages/4c778760be26d8b3/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/pages/117708e0af7f0bd9/" class="nav-link">Nodejs</a></li><li class="dropdown-item"><!----> <a href="/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/pages/aea6571b7a8bae86/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/andanyang/vuepress-theme-vdoing" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/logo.png"> <div class="blogger-info"><h3>Young</h3> <span></span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/Spring/" class="nav-link">Spring</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端文章1</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/8143cc480faf9a11/" class="nav-link">JavaScript</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/javascript/" class="nav-link">《JavaScript教程》</a></li><li class="dropdown-subitem"><a href="/note/js/" class="nav-link">《JavaScript高级程序设计》</a></li><li class="dropdown-subitem"><a href="/note/es6/" class="nav-link">《ES6 教程》</a></li><li class="dropdown-subitem"><a href="/note/vue/" class="nav-link">《Vue》</a></li><li class="dropdown-subitem"><a href="/note/react/" class="nav-link">《React》</a></li><li class="dropdown-subitem"><a href="/note/typescript-axios/" class="nav-link">《TypeScript 从零实现 axios》</a></li><li class="dropdown-subitem"><a href="/note/git/" class="nav-link">《Git》</a></li><li class="dropdown-subitem"><a href="/pages/51afd6/" class="nav-link">TypeScript</a></li><li class="dropdown-subitem"><a href="/pages/4643cd/" class="nav-link">JS设计模式总结</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="页面" class="dropdown-title"><a href="/ui/" class="link-title">页面</a> <span class="title" style="display:none;">页面</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/8309a5b876fc95e3/" class="nav-link">HTML</a></li><li class="dropdown-item"><!----> <a href="/pages/0a83b083bdf257cb/" class="nav-link">CSS</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/technology/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/9a7ee40fc232253e/" class="nav-link">技术文档</a></li><li class="dropdown-item"><!----> <a href="/pages/4c778760be26d8b3/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/pages/117708e0af7f0bd9/" class="nav-link">Nodejs</a></li><li class="dropdown-item"><!----> <a href="/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/pages/aea6571b7a8bae86/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/andanyang/vuepress-theme-vdoing" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/springboot/Actuator/" class="sidebar-link">SpringBoot 监控神器——Actuator 保姆级教程</a></li><li><a href="/pages/fcabaf/" class="sidebar-link">什么是多租户架构？</a></li><li><a href="/Spring boot/MybatisPlus-Transaction /" class="sidebar-link">小心 MybatisPlus 的一个坑与面试题 Transaction rolled back because it has been marked as rollback-only</a></li><li><a href="/pages/f63cbe/" class="sidebar-link">SpringBoot 插件化开发模式详细总结</a></li><li><a href="/Spring_boot/cas/" aria-current="page" class="active sidebar-link">Untitled</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/Spring_boot/cas/#传统-session-机制及身份认证方案" class="sidebar-link">传统 Session 机制及身份认证方案</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/Spring_boot/cas/#cookie-与服务器的交互" class="sidebar-link">Cookie 与服务器的交互</a></li><li class="sidebar-sub-header level3"><a href="/Spring_boot/cas/#服务器端的-session-的机制" class="sidebar-link">服务器端的 session 的机制</a></li><li class="sidebar-sub-header level3"><a href="/Spring_boot/cas/#基于-session-的身份认证流程" class="sidebar-link">基于 session 的身份认证流程</a></li><li class="sidebar-sub-header level3"><a href="/Spring_boot/cas/#集群环境下的-session-困境及解决方案" class="sidebar-link">集群环境下的 Session 困境及解决方案</a></li><li class="sidebar-sub-header level3"><a href="/Spring_boot/cas/#session-共享方案" class="sidebar-link">Session 共享方案</a></li><li class="sidebar-sub-header level3"><a href="/Spring_boot/cas/#session-复制" class="sidebar-link">session 复制</a></li><li class="sidebar-sub-header level3"><a href="/Spring_boot/cas/#session-集中存储" class="sidebar-link">session 集中存储</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/Spring_boot/cas/#多服务下的登陆困境及-sso-方案" class="sidebar-link">多服务下的登陆困境及 SSO 方案</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/Spring_boot/cas/#sso-的产生背景" class="sidebar-link">SSO 的产生背景</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/Spring_boot/cas/#sso-的底层原理-cas" class="sidebar-link">SSO 的底层原理 CAS</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/Spring_boot/cas/#cas-实现单点登录流程" class="sidebar-link">CAS 实现单点登录流程</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/Spring_boot/cas/#单点登录流程演示" class="sidebar-link">单点登录流程演示</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/Spring_boot/cas/#cas-登录服务-demo-核心代码" class="sidebar-link">CAS 登录服务 demo 核心代码</a></li><li class="sidebar-sub-header level3"><a href="/Spring_boot/cas/#web-系统-demo-核心代码" class="sidebar-link">web 系统 demo 核心代码</a></li><li class="sidebar-sub-header level3"><a href="/Spring_boot/cas/#cas-的单点登录和-oauth2-的区别" class="sidebar-link">CAS 的单点登录和 OAuth2 的区别</a></li></ul></li></ul></li><li><a href="/Spring_boot/read_cinfog/" class="sidebar-link">SpringBoot读配置的6种方式</a></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/categories/?category=Spring%20boot" title="分类" data-v-06225672>Spring boot</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/andanyoung" target="_blank" title="作者" class="beLink" data-v-06225672>andanyang</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2023-06-19</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">Untitled<!----></h1>  <div class="theme-vdoing-content content__default"><p>最近开发新产品，然后老板说我们现在系统太多了，每次切换系统登录太麻烦了，能不能做个优化，同一账号互通掉。作为一个资深架构狮，老板的要求肯定要满足，安排！</p> <p>一个公司产品矩阵比较丰富的时候，用户在不同系统之间来回切换，固然对产品用户体验上较差，并且增加用户密码管理成本。也没有很好地利用内部流量进行用户打通，并且每个产品的独立体系会导致产品安全度下降。因此实现集团产品的单点登录对用户使用体验以及效率提升有很大的帮助。那么如何实现统一认证呢？我们先了解一下传统的身份验证方式。</p> <h2 id="传统-session-机制及身份认证方案"><a href="#传统-session-机制及身份认证方案" class="header-anchor">#</a> 传统 Session 机制及身份认证方案</h2> <h3 id="cookie-与服务器的交互"><a href="#cookie-与服务器的交互" class="header-anchor">#</a> Cookie 与服务器的交互</h3> <p>![](../.vuepress/public/Spring boot/b5fa876adb1818be66563c3cef16d13c.jpeg)</p> <p>Cookie 与服务器的交互众所周知，http 是无状态的协议，因此客户每次通过浏览器访问 web 页面，请求到服务端时，服务器都会新建线程，打开新的会话，而且服务器也不会自动维护客户的上下文信息。比如我们现在要实现一个电商内的购物车功能，要怎么才能知道哪些购物车请求对应的是来自同一个客户的请求呢？</p> <p>![](../.vuepress/public/Spring boot/fa848b76103f395154a26cf9d118eafe.jpeg)</p> <p>因此出现了 session 这个概念，session 就是一种保存上下文信息的机制，他是面向用户的，每一个 SessionID 对应着一个用户，并且保存在服务端中。session 主要 以 cookie 或 URL 重写为基础的来实现的，默认使用 cookie 来实现，系统会创造一个名为 JSESSIONID 的变量输出到 cookie 中。</p> <p>JSESSIONID 是存储于浏览器内存中的，并不是写到硬盘上的，如果我们把浏览器的 cookie 禁止，则 web 服务器会采用 URL 重写的方式传递 Sessionid，我们就可以在地址栏看到 sessionid=KWJHUG6JJM65HS2K6 之类的字符串。</p> <p>通常 JSESSIONID 是不能跨窗口使用的，当你新开了一个浏览器窗口进入相同页面时，系统会赋予你一个新的 sessionid，这样我们信息共享的目的就达不到了。</p> <h3 id="服务器端的-session-的机制"><a href="#服务器端的-session-的机制" class="header-anchor">#</a> 服务器端的 session 的机制</h3> <p>当服务端收到客户端的请求时候，首先判断请求里是否包含了 JSESSIONID 的 sessionId，如果存在说明已经创建过了，直接从内存中拿出来使用，如果查询不到，说明是无效的。如果客户请求不包含 sessionid，则为此客户创建一个 session 并且生成一个与此 session 相关联的 sessionid，这个 sessionid 将在本次响应中返回给客户端保存。对每次 http 请求，都经历以下步骤处理：</p> <ul><li><p>服务端首先查找对应的 cookie 的值（sessionid）。</p></li> <li><p>根据 sessionid，从服务器端 session 存储中获取对应 id 的 session 数据，进行返回。</p></li> <li><p>如果找不到 sessionid，服务器端就创建 session，生成 sessionid 对应的 cookie，写入到响应头中。</p></li></ul> <p>session 是由服务端生成的，并且以散列表的形式保存在内存中</p> <h3 id="基于-session-的身份认证流程"><a href="#基于-session-的身份认证流程" class="header-anchor">#</a> 基于 session 的身份认证流程</h3> <p>基于 seesion 的身份认证主要流程如下：</p> <p>![](../.vuepress/public/Spring boot/24f8287d7f7f53ea51af2fd20d4583ee.jpeg)</p> <p>因为 http 请求是无状态请求，所以在 Web 领域，大部分都是通过这种方式解决。但是这么做有什么问题呢？我们接着看</p> <h3 id="集群环境下的-session-困境及解决方案"><a href="#集群环境下的-session-困境及解决方案" class="header-anchor">#</a> 集群环境下的 Session 困境及解决方案</h3> <p>![](../.vuepress/public/Spring boot/79595ac2da0d2caf8d806d8fffc1cecb.jpeg)</p> <p>集群环境下的 Session 困境及解决方案随着技术的发展，用户流量增大，单个服务器已经不能满足系统的需要了，分布式架构开始流行。通常都会把系统部署在多台服务器上，通过负载均衡把请求分发到其中的一台服务器上，这样很可能同一个用户的请求被分发到不同的服务器上，因为 session 是保存在服务器上的，那么很有可能第一次请求访问的 A 服务器，创建了 session，但是第二次访问到了 B 服务器，这时就会出现取不到 session 的情况。</p> <p>我们知道，Session 一般是用来存会话全局的用户信息（不仅仅是登陆方面的问题），用来简化 / 加速后续的业务请求。</p> <p>传统的 session 由服务器端生成并存储，当应用进行分布式集群部署的时候，如何保证不同服务器上 session 信息能够共享呢？</p> <h3 id="session-共享方案"><a href="#session-共享方案" class="header-anchor">#</a> Session 共享方案</h3> <p>Session 共享一般有两种思路</p> <ul><li><p>session 复制</p></li> <li><p>session 集中存储</p></li></ul> <h3 id="session-复制"><a href="#session-复制" class="header-anchor">#</a> session 复制</h3> <p>session 复制即将不同服务器上 session 数据进行复制，用户登录，修改，注销时，将 session 信息同时也复制到其他机器上面去。</p> <p>![](../.vuepress/public/Spring boot/4dadf5fea6881e2a0f312c5148f88d43.jpeg)</p> <p>session 复制</p> <p>这种实现的问题就是实现成本高，维护难度大，并且会存在延迟登问题。</p> <h3 id="session-集中存储"><a href="#session-集中存储" class="header-anchor">#</a> session 集中存储</h3> <p>![](../.vuepress/public/Spring boot/0522043ffca3595467012ce6f3a3d25e.jpeg)</p> <p>session 集中存储集中存储就是将获取 session 单独放在一个服务中进行存储，所有获取 session 的统一来这个服务中去取。这样就避免了同步和维护多套 session 的问题。一般我们都是使用 redis 进行集中式存储 session。</p> <h2 id="多服务下的登陆困境及-sso-方案"><a href="#多服务下的登陆困境及-sso-方案" class="header-anchor">#</a> 多服务下的登陆困境及 SSO 方案</h2> <h3 id="sso-的产生背景"><a href="#sso-的产生背景" class="header-anchor">#</a> SSO 的产生背景</h3> <p>![](../.vuepress/public/Spring boot/fa098b26574dec355a655c23b2ebfc68.jpeg)</p> <p>如果企业做大了之后，一般都有很多的业务支持系统为其提供相应的管理和 IT 服务，按照传统的验证方式访问多系统，每个单独的系统都会有自己的安全体系和身份认证系统。进入每个系统都需要进行登录，获取 session，再通过 session 访问对应系统资源。这样的局面不仅给管理上带来了很大的困难，对客户来说也极不友好，那么如何让客户只需登陆一次，就可以进入多个系统，而不需要重新登录呢？</p> <p>![](../.vuepress/public/Spring boot/72afd2d4a65fe0800605d5b3255b56c0.jpeg)</p> <p>“单点登录” 就是专为解决此类问题的。其大致思想流程如下：通过一个 ticket 进行串接各系统间的用户信息</p> <h2 id="sso-的底层原理-cas"><a href="#sso-的底层原理-cas" class="header-anchor">#</a> SSO 的底层原理 CAS</h2> <h3 id="cas-实现单点登录流程"><a href="#cas-实现单点登录流程" class="header-anchor">#</a> CAS 实现单点登录流程</h3> <p>我们知道对于完全不同域名的系统，cookie 是无法跨域名共享的，因此 sessionId 在页面端也无法共享，因此需要实现单店登录，就需要启用一个专门用来登录的域名如（ouath.com）来提供所有系统的 sessionId。当业务系统被打开时，借助中心授权系统进行登录，整体流程如下：</p> <ol><li><p>当 b.com 打开时，发现自己未登陆，于是跳转到 ouath.com 去登陆</p></li> <li><p>ouath.com 登陆页面被打开，用户输入帐户 / 密码登陆成功</p></li> <li><p>ouath.com 登陆成功，种 cookie 到 ouath.com 域名下</p></li> <li><p>把 sessionid 放入后台 redis，存放 &lt;ticket，sesssionid&gt; 数据结构，然后页面重定向到 A 系统</p></li> <li><p>当 b.com 重新被打开，发现仍然是未登陆，但是有了一个 ticket 值</p></li> <li><p>当 b.com 用 ticket 值，到 redis 里查到 sessionid，并做 session 同步，然后种 cookie 给自己，页面原地重定向</p></li> <li><p>当 b.com 打开自己页面，此时有了 cookie，后台校验登陆状态，成功</p></li></ol> <p>整个交互流程图如下：</p> <p>![](../.vuepress/public/Spring boot/1607832289d71cf293eb9a95d42bf4f7.jpeg)</p> <h2 id="单点登录流程演示"><a href="#单点登录流程演示" class="header-anchor">#</a> 单点登录流程演示</h2> <h3 id="cas-登录服务-demo-核心代码"><a href="#cas-登录服务-demo-核心代码" class="header-anchor">#</a> CAS 登录服务 demo 核心代码</h3> <p>1、用户实体类</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>public class UserForm implements Serializable{
  private static final long serialVersionUID = 1L;
 
  private String username;
  private String password;
  private String backurl;
 
  public String getUsername() {
      return username;
  }
 
  public void setUsername(String username) {
      this.username = username;
  }
 
  public String getPassword() {
      return password;
  }
 
  public void setPassword(String password) {
      this.password = password;
  }
 
  public String getBackurl() {
      return backurl;
  }
 
  public void setBackurl(String backurl) {
      this.backurl = backurl;
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p>2、登录控制器</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>@Controller
public class IndexController {
    @Autowired
    private RedisTemplate redisTemplate;
 
  @GetMapping(&quot;/toLogin&quot;)
  public String toLogin(Model model,HttpServletRequest request) {
      Object userInfo = request.getSession().getAttribute(LoginFilter.USER_INFO);
      //不为空，则是已登陆状态
      if (null != userInfo){
          String ticket = UUID.randomUUID().toString();
          redisTemplate.opsForValue().set(ticket,userInfo,2, TimeUnit.SECONDS);
          return &quot;redirect:&quot;+request.getParameter(&quot;url&quot;)+&quot;?ticket=&quot;+ticket;
      }
      UserForm user = new UserForm();
      user.setUsername(&quot;laowang&quot;);
      user.setPassword(&quot;laowang&quot;);
      user.setBackurl(request.getParameter(&quot;url&quot;));
      model.addAttribute(&quot;user&quot;, user);
 
      return &quot;login&quot;;
  }
 
  @PostMapping(&quot;/login&quot;)
  public void login(@ModelAttribute UserForm user,HttpServletRequest request,HttpServletResponse response) throws IOException, ServletException {
      System.out.println(&quot;backurl:&quot;+user.getBackurl());
      request.getSession().setAttribute(LoginFilter.USER_INFO,user);
 
      //登陆成功，创建用户信息票据
      String ticket = UUID.randomUUID().toString();
      redisTemplate.opsForValue().set(ticket,user,20, TimeUnit.SECONDS);
      //重定向，回原url  ---a.com
      if (null == user.getBackurl() || user.getBackurl().length()==0){
          response.sendRedirect(&quot;/index&quot;);
      } else {
          response.sendRedirect(user.getBackurl()+&quot;?ticket=&quot;+ticket);
      }
  }
 
  @GetMapping(&quot;/index&quot;)
  public ModelAndView index(HttpServletRequest request) {
      ModelAndView modelAndView = new ModelAndView();
      Object user = request.getSession().getAttribute(LoginFilter.USER_INFO);
      UserForm userInfo = (UserForm) user;
      modelAndView.setViewName(&quot;index&quot;);
      modelAndView.addObject(&quot;user&quot;, userInfo);
      request.getSession().setAttribute(&quot;test&quot;,&quot;123&quot;);
      return modelAndView;
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br></div></div><p>3、登录过滤器</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>public class LoginFilter implements Filter {
    public static final String USER_INFO = &quot;user&quot;;
    @Override
    public void init(FilterConfig filterConfig) throws ServletException {}
 
  @Override
  public void doFilter(ServletRequest servletRequest,
                       ServletResponse servletResponse, FilterChain filterChain)
          throws IOException, ServletException {
 
      HttpServletRequest request = (HttpServletRequest) servletRequest;
       HttpServletResponse response = (HttpServletResponse)servletResponse;
 
      Object userInfo = request.getSession().getAttribute(USER_INFO);;
 
      //如果未登陆，则拒绝请求，转向登陆页面
      String requestUrl = request.getServletPath();
      if (!&quot;/toLogin&quot;.equals(requestUrl)//不是登陆页面
              &amp;&amp; !requestUrl.startsWith(&quot;/login&quot;)//不是去登陆
              &amp;&amp; null == userInfo) {//不是登陆状态
 
          request.getRequestDispatcher(&quot;/toLogin&quot;).forward(request,response);
          return ;
      }
 
      filterChain.doFilter(request,servletResponse);
  }
 
  @Override
  public void destroy() {
 
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><p>4、配置过滤器</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>@Configuration
public class LoginConfig {
 
//配置filter生效
@Bean
public FilterRegistrationBean sessionFilterRegistration() {
 
    FilterRegistrationBean registration = new FilterRegistrationBean();
    registration.setFilter(new LoginFilter());
    registration.addUrlPatterns(&quot;/*&quot;);
    registration.addInitParameter(&quot;paramName&quot;, &quot;paramValue&quot;);
    registration.setName(&quot;sessionFilter&quot;);
    registration.setOrder(1);
    return registration;
}
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>5、登录页面</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;!DOCTYPE HTML&gt;
&lt;html xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;
&lt;head&gt;
    &lt;title&gt;enjoy login&lt;/title&gt;
    &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div text-align=&quot;center&quot;&gt;
    &lt;h1&gt;请登陆&lt;/h1&gt;
    &lt;form action=&quot;#&quot; th:action=&quot;@{/login}&quot; th:object=&quot;${user}&quot; method=&quot;post&quot;&gt;
        &lt;p&gt;用户名: &lt;input type=&quot;text&quot; th:field=&quot;*{username}&quot; /&gt;&lt;/p&gt;
        &lt;p&gt;密  码: &lt;input type=&quot;text&quot; th:field=&quot;*{password}&quot; /&gt;&lt;/p&gt;
        &lt;p&gt;&lt;input type=&quot;submit&quot; value=&quot;Submit&quot; /&gt; &lt;input type=&quot;reset&quot; value=&quot;Reset&quot; /&gt;&lt;/p&gt;
        &lt;input type=&quot;text&quot; th:field=&quot;*{backurl}&quot; hidden=&quot;hidden&quot; /&gt;
    &lt;/form&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="web-系统-demo-核心代码"><a href="#web-系统-demo-核心代码" class="header-anchor">#</a> web 系统 demo 核心代码</h3> <p>过滤器</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>public class SSOFilter implements Filter {
    private RedisTemplate redisTemplate;
 
    public static final String USER_INFO = &quot;user&quot;;
 
    public SSOFilter(RedisTemplate redisTemplate){
        this.redisTemplate = redisTemplate;
    }
    @Override
    public void init(FilterConfig filterConfig) throws ServletException {
 
    }
 
    @Override
    public void doFilter(ServletRequest servletRequest,
                         ServletResponse servletResponse, FilterChain filterChain)
            throws IOException, ServletException {
 
        HttpServletRequest request = (HttpServletRequest) servletRequest;
        HttpServletResponse response = (HttpServletResponse)servletResponse;
 
        Object userInfo = request.getSession().getAttribute(USER_INFO);;
 
        //如果未登陆，则拒绝请求，转向登陆页面
        String requestUrl = request.getServletPath();
        if (!&quot;/toLogin&quot;.equals(requestUrl)//不是登陆页面
                &amp;&amp; !requestUrl.startsWith(&quot;/login&quot;)//不是去登陆
                &amp;&amp; null == userInfo) {//不是登陆状态
 
            String ticket = request.getParameter(&quot;ticket&quot;);
            //有票据,则使用票据去尝试拿取用户信息
            if (null != ticket){
                userInfo = redisTemplate.opsForValue().get(ticket);
            }
            //无法得到用户信息，则去登陆页面
            if (null == userInfo){
                response.sendRedirect(&quot;http://127.0.0.1:8080/toLogin?url=&quot;+request.getRequestURL().toString());
                return ;
            }
 
            /**
             * 将用户信息，加载进session中
             */
            UserForm user = (UserForm) userInfo;
            request.getSession().setAttribute(SSOFilter.USER_INFO,user);
            redisTemplate.delete(ticket);
        }
 
        filterChain.doFilter(request,servletResponse);
    }
 
    @Override
    public void destroy() {
 
    }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br></div></div><p>控制器</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>@Controller
public class IndexController {
    @Autowired
    private RedisTemplate redisTemplate;
 
    @GetMapping(&quot;/index&quot;)
    public ModelAndView index(HttpServletRequest request) {
        ModelAndView modelAndView = new ModelAndView();
        Object userInfo = request.getSession().getAttribute(SSOFilter.USER_INFO);
        UserForm user = (UserForm) userInfo;
        modelAndView.setViewName(&quot;index&quot;);
        modelAndView.addObject(&quot;user&quot;, user);
 
        request.getSession().setAttribute(&quot;test&quot;,&quot;123&quot;);
        return modelAndView;
    }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>首页</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;!DOCTYPE HTML&gt;
&lt;html xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;
&lt;head&gt;
    &lt;title&gt;enjoy index&lt;/title&gt;
    &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div th:object=&quot;${user}&quot;&gt;
    &lt;h1&gt;cas-website：欢迎你&quot;&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="cas-的单点登录和-oauth2-的区别"><a href="#cas-的单点登录和-oauth2-的区别" class="header-anchor">#</a> CAS 的单点登录和 OAuth2 的区别</h3> <ul><li><p>OAuth2: 三方授权协议，允许用户在不提供账号密码的情况下，通过信任的应用进行授权，使其客户端可以访问权限范围内的资源。</p></li> <li><p>CAS: 中央认证服务（Central Authentication Service），一个基于 Kerberos 票据方式实现 SSO 单点登录的框架，为 Web 应用系统提供一种可靠的单点登录解决方法（属于 Web SSO ）。</p></li></ul> <ol><li><p>CAS 的单点登录时保障客户端的用户资源的安全 ；OAuth2 则是保障服务端的用户资源的安全 。</p></li> <li><p>CAS 客户端要获取的最终信息是，这个用户到底有没有权限访问我（CAS 客户端）的资源；OAuth2 获取的最终信息是，我（oauth2 服务提供方）的用户的资源到底能不能让你（oauth2 的客户端）访问。</p></li></ol> <p>因此，需要统一的账号密码进行身份认证，用 CAS；需要授权第三方服务使用我方资源，使用 OAuth2。</p></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/andanyang/vuepress-theme-vdoing/edit/master/docs/Spring boot/10003.springboot cas 概念.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2023/06/20, 05:32:27</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/f63cbe/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">SpringBoot 插件化开发模式详细总结</div></a> <a href="/Spring_boot/read_cinfog/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">SpringBoot读配置的6种方式</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/f63cbe/" class="prev">SpringBoot 插件化开发模式详细总结</a></span> <span class="next"><a href="/Spring_boot/read_cinfog/">SpringBoot读配置的6种方式</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/mysql/Master_slave_replication_delay/"><div>
            高频面试：如何解决MySQL主从复制延时问题
            <!----></div></a> <span class="date">06-20</span></dt></dl><dl><dd>02</dd> <dt><a href="/Hadoop/Yarn/"><div>
            大数据技术之 Hadoop（Yarn）
            <!----></div></a> <span class="date">06-20</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/5cb5f8/"><div>
            Hadoop 数据压缩
            <!----></div></a> <span class="date">06-19</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:1218853253@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/andanyang" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=755597173" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2019-2023
    <span>Young | <a href="https://github.com/andanyoung/young-blog/blob/master/LICENSE" target="_blank">MIT License</a> <br/> <a  href="https://beian.miit.gov.cn/" target="_blank">浙ICP备20002744号</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.abbd16b8.js" defer></script><script src="/assets/js/2.dfbf9bb4.js" defer></script><script src="/assets/js/45.aabd696d.js" defer></script>
  </body>
</html>
