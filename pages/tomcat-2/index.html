<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Tomcat(二)：tomcat配置文件server.xml详解和部署简介 | Young&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="Young丶java后端技术博客,专注后端学习与总结。擅长spring boot,JAVA基础总结,等方面的知识,关注spring,架构,elasticsearch,mysql领域.">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.d9c8cf8c.css" as="style"><link rel="preload" href="/assets/js/app.40283726.js" as="script"><link rel="preload" href="/assets/js/2.f3a5e277.js" as="script"><link rel="preload" href="/assets/js/99.54eed138.js" as="script"><link rel="prefetch" href="/assets/js/10.2d00524d.js"><link rel="prefetch" href="/assets/js/100.56a4fd14.js"><link rel="prefetch" href="/assets/js/101.0946b2aa.js"><link rel="prefetch" href="/assets/js/102.01505964.js"><link rel="prefetch" href="/assets/js/103.24eb3451.js"><link rel="prefetch" href="/assets/js/104.64871ef7.js"><link rel="prefetch" href="/assets/js/105.f2fec7af.js"><link rel="prefetch" href="/assets/js/106.951f5a58.js"><link rel="prefetch" href="/assets/js/107.1ddc31db.js"><link rel="prefetch" href="/assets/js/108.c3819791.js"><link rel="prefetch" href="/assets/js/109.b297461f.js"><link rel="prefetch" href="/assets/js/11.7681133b.js"><link rel="prefetch" href="/assets/js/110.b90fd219.js"><link rel="prefetch" href="/assets/js/111.14c41614.js"><link rel="prefetch" href="/assets/js/112.9ee8decf.js"><link rel="prefetch" href="/assets/js/113.bbde81da.js"><link rel="prefetch" href="/assets/js/12.7c259f4c.js"><link rel="prefetch" href="/assets/js/13.495d3be9.js"><link rel="prefetch" href="/assets/js/14.020cb621.js"><link rel="prefetch" href="/assets/js/15.0cfe3cc5.js"><link rel="prefetch" href="/assets/js/16.62f664d5.js"><link rel="prefetch" href="/assets/js/17.9b9ad687.js"><link rel="prefetch" href="/assets/js/18.168621d7.js"><link rel="prefetch" href="/assets/js/19.af03cd28.js"><link rel="prefetch" href="/assets/js/20.2717a48b.js"><link rel="prefetch" href="/assets/js/21.c7997937.js"><link rel="prefetch" href="/assets/js/22.aa528af5.js"><link rel="prefetch" href="/assets/js/23.b9dcceba.js"><link rel="prefetch" href="/assets/js/24.f7c7482b.js"><link rel="prefetch" href="/assets/js/25.4026d7a3.js"><link rel="prefetch" href="/assets/js/26.39bb4987.js"><link rel="prefetch" href="/assets/js/27.6518dad9.js"><link rel="prefetch" href="/assets/js/28.bfca95b6.js"><link rel="prefetch" href="/assets/js/29.f7252f46.js"><link rel="prefetch" href="/assets/js/3.24a9a6b4.js"><link rel="prefetch" href="/assets/js/30.10149c6c.js"><link rel="prefetch" href="/assets/js/31.6395495b.js"><link rel="prefetch" href="/assets/js/32.d5c5002c.js"><link rel="prefetch" href="/assets/js/33.7d245dcf.js"><link rel="prefetch" href="/assets/js/34.308ff4b4.js"><link rel="prefetch" href="/assets/js/35.3232556b.js"><link rel="prefetch" href="/assets/js/36.be90b67e.js"><link rel="prefetch" href="/assets/js/37.50856d56.js"><link rel="prefetch" href="/assets/js/38.711d94b8.js"><link rel="prefetch" href="/assets/js/39.48d8ea3c.js"><link rel="prefetch" href="/assets/js/4.d2c061ed.js"><link rel="prefetch" href="/assets/js/40.a763db8c.js"><link rel="prefetch" href="/assets/js/41.9bc73d22.js"><link rel="prefetch" href="/assets/js/42.b26527c1.js"><link rel="prefetch" href="/assets/js/43.e1552e7c.js"><link rel="prefetch" href="/assets/js/44.8f6e52a9.js"><link rel="prefetch" href="/assets/js/45.1262c6dd.js"><link rel="prefetch" href="/assets/js/46.19e24941.js"><link rel="prefetch" href="/assets/js/47.7754debb.js"><link rel="prefetch" href="/assets/js/48.447e915c.js"><link rel="prefetch" href="/assets/js/49.75212718.js"><link rel="prefetch" href="/assets/js/5.387a84d1.js"><link rel="prefetch" href="/assets/js/50.25c97120.js"><link rel="prefetch" href="/assets/js/51.737610cc.js"><link rel="prefetch" href="/assets/js/52.afcf8141.js"><link rel="prefetch" href="/assets/js/53.249c3e09.js"><link rel="prefetch" href="/assets/js/54.61e5bc3d.js"><link rel="prefetch" href="/assets/js/55.ea75200d.js"><link rel="prefetch" href="/assets/js/56.b5295ab4.js"><link rel="prefetch" href="/assets/js/57.11f5768e.js"><link rel="prefetch" href="/assets/js/58.1099036e.js"><link rel="prefetch" href="/assets/js/59.5ec198b4.js"><link rel="prefetch" href="/assets/js/6.d0a48527.js"><link rel="prefetch" href="/assets/js/60.4f57ed5e.js"><link rel="prefetch" href="/assets/js/61.f0db6256.js"><link rel="prefetch" href="/assets/js/62.6dcb1828.js"><link rel="prefetch" href="/assets/js/63.76471f41.js"><link rel="prefetch" href="/assets/js/64.ebb5e1ac.js"><link rel="prefetch" href="/assets/js/65.155b6fb5.js"><link rel="prefetch" href="/assets/js/66.2bd96565.js"><link rel="prefetch" href="/assets/js/67.49128eda.js"><link rel="prefetch" href="/assets/js/68.c1855f1e.js"><link rel="prefetch" href="/assets/js/69.629fe500.js"><link rel="prefetch" href="/assets/js/7.ee42d17b.js"><link rel="prefetch" href="/assets/js/70.80566b84.js"><link rel="prefetch" href="/assets/js/71.024dea36.js"><link rel="prefetch" href="/assets/js/72.a4ddbbad.js"><link rel="prefetch" href="/assets/js/73.c34ea399.js"><link rel="prefetch" href="/assets/js/74.c0791237.js"><link rel="prefetch" href="/assets/js/75.585a06e7.js"><link rel="prefetch" href="/assets/js/76.8f57b940.js"><link rel="prefetch" href="/assets/js/77.18da0d5a.js"><link rel="prefetch" href="/assets/js/78.980dca88.js"><link rel="prefetch" href="/assets/js/79.68a50efc.js"><link rel="prefetch" href="/assets/js/8.b7caf21c.js"><link rel="prefetch" href="/assets/js/80.8e6a7956.js"><link rel="prefetch" href="/assets/js/81.b6646f2e.js"><link rel="prefetch" href="/assets/js/82.c3392997.js"><link rel="prefetch" href="/assets/js/83.fa977f62.js"><link rel="prefetch" href="/assets/js/84.36cc9afe.js"><link rel="prefetch" href="/assets/js/85.65c880f2.js"><link rel="prefetch" href="/assets/js/86.b3de7f70.js"><link rel="prefetch" href="/assets/js/87.616f228c.js"><link rel="prefetch" href="/assets/js/88.3a2b4704.js"><link rel="prefetch" href="/assets/js/89.0e6944e1.js"><link rel="prefetch" href="/assets/js/9.20f08857.js"><link rel="prefetch" href="/assets/js/90.d3f49a0a.js"><link rel="prefetch" href="/assets/js/91.be832135.js"><link rel="prefetch" href="/assets/js/92.42f17054.js"><link rel="prefetch" href="/assets/js/93.c9e205c9.js"><link rel="prefetch" href="/assets/js/94.2ee9e307.js"><link rel="prefetch" href="/assets/js/95.ddecb3b4.js"><link rel="prefetch" href="/assets/js/96.564531cd.js"><link rel="prefetch" href="/assets/js/97.01f7443c.js"><link rel="prefetch" href="/assets/js/98.356d6846.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d9c8cf8c.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="Young's blog" class="logo"> <span class="site-name can-hide">Young's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/Spring/" class="nav-link">Spring</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端文章1</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/8143cc480faf9a11/" class="nav-link">JavaScript</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/javascript/" class="nav-link">《JavaScript教程》</a></li><li class="dropdown-subitem"><a href="/note/js/" class="nav-link">《JavaScript高级程序设计》</a></li><li class="dropdown-subitem"><a href="/note/es6/" class="nav-link">《ES6 教程》</a></li><li class="dropdown-subitem"><a href="/note/vue/" class="nav-link">《Vue》</a></li><li class="dropdown-subitem"><a href="/note/react/" class="nav-link">《React》</a></li><li class="dropdown-subitem"><a href="/note/typescript-axios/" class="nav-link">《TypeScript 从零实现 axios》</a></li><li class="dropdown-subitem"><a href="/note/git/" class="nav-link">《Git》</a></li><li class="dropdown-subitem"><a href="/pages/51afd6/" class="nav-link">TypeScript</a></li><li class="dropdown-subitem"><a href="/pages/4643cd/" class="nav-link">JS设计模式总结</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="页面" class="dropdown-title"><a href="/ui/" class="link-title">页面</a> <span class="title" style="display:none;">页面</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/8309a5b876fc95e3/" class="nav-link">HTML</a></li><li class="dropdown-item"><!----> <a href="/pages/0a83b083bdf257cb/" class="nav-link">CSS</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/technology/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/9a7ee40fc232253e/" class="nav-link">技术文档</a></li><li class="dropdown-item"><!----> <a href="/pages/4c778760be26d8b3/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/pages/117708e0af7f0bd9/" class="nav-link">Nodejs</a></li><li class="dropdown-item"><!----> <a href="/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/pages/aea6571b7a8bae86/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/andanyang/vuepress-theme-vdoing" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/logo.png"> <div class="blogger-info"><h3>Young</h3> <span></span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/Spring/" class="nav-link">Spring</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端文章1</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/8143cc480faf9a11/" class="nav-link">JavaScript</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/javascript/" class="nav-link">《JavaScript教程》</a></li><li class="dropdown-subitem"><a href="/note/js/" class="nav-link">《JavaScript高级程序设计》</a></li><li class="dropdown-subitem"><a href="/note/es6/" class="nav-link">《ES6 教程》</a></li><li class="dropdown-subitem"><a href="/note/vue/" class="nav-link">《Vue》</a></li><li class="dropdown-subitem"><a href="/note/react/" class="nav-link">《React》</a></li><li class="dropdown-subitem"><a href="/note/typescript-axios/" class="nav-link">《TypeScript 从零实现 axios》</a></li><li class="dropdown-subitem"><a href="/note/git/" class="nav-link">《Git》</a></li><li class="dropdown-subitem"><a href="/pages/51afd6/" class="nav-link">TypeScript</a></li><li class="dropdown-subitem"><a href="/pages/4643cd/" class="nav-link">JS设计模式总结</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="页面" class="dropdown-title"><a href="/ui/" class="link-title">页面</a> <span class="title" style="display:none;">页面</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/8309a5b876fc95e3/" class="nav-link">HTML</a></li><li class="dropdown-item"><!----> <a href="/pages/0a83b083bdf257cb/" class="nav-link">CSS</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/technology/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/9a7ee40fc232253e/" class="nav-link">技术文档</a></li><li class="dropdown-item"><!----> <a href="/pages/4c778760be26d8b3/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/pages/117708e0af7f0bd9/" class="nav-link">Nodejs</a></li><li class="dropdown-item"><!----> <a href="/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/pages/aea6571b7a8bae86/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/andanyang/vuepress-theme-vdoing" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/pages/tomcat-1/" class="sidebar-link">Tomcat(一)：背景知识和安装tomcat</a></li><li><a href="/pages/tomcat-2/" aria-current="page" class="active sidebar-link">Tomcat(二)：tomcat配置文件server.xml详解和部署简介</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/tomcat-2/#_5-1-顶级元素-server" class="sidebar-link">5.1 顶级元素 server</a></li><li class="sidebar-sub-header level2"><a href="/pages/tomcat-2/#_5-2-顶级元素-service" class="sidebar-link">5.2 顶级元素 service</a></li><li class="sidebar-sub-header level2"><a href="/pages/tomcat-2/#_5-3-执行器-executor" class="sidebar-link">5.3 执行器 executor</a></li><li class="sidebar-sub-header level2"><a href="/pages/tomcat-2/#_5-4-连接器-connector" class="sidebar-link">5.4 连接器 connector</a></li><li class="sidebar-sub-header level2"><a href="/pages/tomcat-2/#_5-5-容器类-engine" class="sidebar-link">5.5 容器类 engine</a></li><li class="sidebar-sub-header level2"><a href="/pages/tomcat-2/#_5-6-容器类-host" class="sidebar-link">5.6 容器类 host</a></li><li class="sidebar-sub-header level2"><a href="/pages/tomcat-2/#_5-7-容器类-context" class="sidebar-link">5.7 容器类 context</a></li><li class="sidebar-sub-header level2"><a href="/pages/tomcat-2/#_5-8-被嵌套类-realm" class="sidebar-link">5.8 被嵌套类 realm</a></li><li class="sidebar-sub-header level2"><a href="/pages/tomcat-2/#_5-9-被嵌套类-valve" class="sidebar-link">5.9 被嵌套类 valve</a></li></ul></li><li><a href="/pages/tomcat-3/" class="sidebar-link">Tomcat(三)：tomcat处理连接的详细过程</a></li><li><a href="/pages/tomcat-4/" class="sidebar-link">Tomcat(四)：tomcat图形管理和身份认证</a></li><li><a href="/pages/tomcat-5/" class="sidebar-link">Tomcat(五)：Tomcat 参数调优教程</a></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/categories/?category=tomcat" title="分类" data-v-06225672>tomcat</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/andanyoung" target="_blank" title="作者" class="beLink" data-v-06225672>andanyang</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2023-03-28</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">Tomcat(二)：tomcat配置文件server.xml详解和部署简介<!----></h1>  <div class="theme-vdoing-content content__default"><h1 id="_1-入门示例-虚拟主机提供-web-服务"><a href="#_1-入门示例-虚拟主机提供-web-服务" class="header-anchor">#</a> 1. 入门示例：虚拟主机提供 web 服务</h1> <p>该示例通过设置虚拟主机来提供 web 服务，因为是入门示例，所以设置极其简单，只需修改<code>$CATALINA_HOME/conf/server.xml</code>文件为如下内容即可，本文的 tomcat 安装在/usr/local/tomcat 下，因此<code>$CATALINA_HOME=/usr/local/tomcat</code>。其中大部分都采用了默认设置，只是在 engine 容器中添加了两个 Host 容器。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Server port=&quot;8005&quot; shutdown=&quot;SHUTDOWN&quot;&gt;
  &lt;Listener className=&quot;org.apache.catalina.startup.VersionLoggerListener&quot; /&gt;
  &lt;Listener className=&quot;org.apache.catalina.core.AprLifecycleListener&quot; SSLEngine=&quot;on&quot; /&gt;
  &lt;Listener className=&quot;org.apache.catalina.core.JreMemoryLeakPreventionListener&quot; /&gt;
  &lt;Listener className=&quot;org.apache.catalina.mbeans.GlobalResourcesLifecycleListener&quot; /&gt;
  &lt;Listener className=&quot;org.apache.catalina.core.ThreadLocalLeakPreventionListener&quot; /&gt;

  &lt;GlobalNamingResources&gt;
    &lt;Resource name=&quot;UserDatabase&quot; auth=&quot;Container&quot;
              type=&quot;org.apache.catalina.UserDatabase&quot;
              description=&quot;User database that can be updated and saved&quot;
              factory=&quot;org.apache.catalina.users.MemoryUserDatabaseFactory&quot;
              pathname=&quot;conf/tomcat-users.xml&quot; /&gt;
  &lt;/GlobalNamingResources&gt;
  &lt;Service name=&quot;Catalina&quot;&gt;
    &lt;Connector port=&quot;8080&quot; protocol=&quot;HTTP/1.1&quot;
               connectionTimeout=&quot;20000&quot;
               redirectPort=&quot;8443&quot; enableLookups=&quot;false&quot; /&gt;
    &lt;Connector port=&quot;8009&quot; protocol=&quot;AJP/1.3&quot; redirectPort=&quot;8443&quot; /&gt;
   &lt;Engine name=&quot;Catalina&quot; defaultHost=&quot;localhost&quot;&gt;
     &lt;Realm className=&quot;org.apache.catalina.realm.LockOutRealm&quot;&gt;
        &lt;Realm className=&quot;org.apache.catalina.realm.UserDatabaseRealm&quot;
               resourceName=&quot;UserDatabase&quot; /&gt;
      &lt;/Realm&gt;

      &lt;!--  从此处开始添加以下两个Host容器作为虚拟主机 --&gt;
     &lt;!-- 定义一个在$CATALINA_HOME之外的虚拟主机 --&gt;
	&lt;Host name=&quot;www.longshuai.com&quot;  appBase=&quot;/www/longshuai&quot;
            unpackWARs=&quot;true&quot; autoDeploy=&quot;true&quot;&gt;
          &lt;Context path=&quot;&quot; docBase=&quot;/www/longshuai&quot; reloadable=&quot;true&quot; /&gt;
          &lt;Context path=&quot;/xuexi&quot; docBase=&quot;xuexi&quot; reloadable=&quot;true&quot; /&gt;
        &lt;Valve className=&quot;org.apache.catalina.valves.AccessLogValve&quot; directory=&quot;logs&quot;
               prefix=&quot;longshuai_access_log&quot; suffix=&quot;.txt&quot;
               pattern=&quot;%h %l %u %t &amp;quot;%r&amp;quot; %s %b&quot; /&gt;
      &lt;/Host&gt;

	&lt;!-- 定义一个在$CATALINA_HOME/webapps下的虚拟主机 --&gt;
	&lt;Host name=&quot;www.xiaofang.com&quot;  appBase=&quot;webapps/xiaofang&quot;
            unpackWARs=&quot;true&quot; autoDeploy=&quot;true&quot;&gt;
          &lt;Context path=&quot;&quot; docBase=&quot;&quot; reloadable=&quot;true&quot; /&gt;
          &lt;Context path=&quot;/xuexi&quot; docBase=&quot;xuexi&quot; reloadable=&quot;true&quot; /&gt;
        &lt;Valve className=&quot;org.apache.catalina.valves.AccessLogValve&quot; directory=&quot;logs&quot;
               prefix=&quot;xiaofang_access_log&quot; suffix=&quot;.txt&quot;
               pattern=&quot;%h %l %u %t &amp;quot;%r&amp;quot; %s %b&quot; /&gt;
      &lt;/Host&gt;

	&lt;!-- 默认虚拟主机localhost，可不修改 --&gt;
	&lt;Host name=&quot;localhost&quot;  appBase=&quot;webapps&quot;
            unpackWARs=&quot;true&quot; autoDeploy=&quot;true&quot;&gt;
        &lt;Valve className=&quot;org.apache.catalina.valves.AccessLogValve&quot; directory=&quot;logs&quot;
               prefix=&quot;localhost_access_log&quot; suffix=&quot;.txt&quot;
               pattern=&quot;%h %l %u %t &amp;quot;%r&amp;quot; %s %b&quot; /&gt;
      &lt;/Host&gt;

    &lt;/Engine&gt;
  &lt;/Service&gt;
&lt;/Server&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br></div></div><div class="language- extra-class"><pre><code>	除了engine中定义的默认`localhost`虚拟主机，另外布置了两个虚拟主机`www.longshuai.com`和`www.xiaofang.com`，它们的程序目录分别为`/www/longshuai`和`$CATALINA_HOME/webapps/xiaofang`，所以需要提前建立好这两个目录。另外，在`context`中定义了`docBase`，对于uri路径/xuexi，它的文件系统路径分别为`/www/longshuai/xuexi`目录和`$CATALINA_HOME/webapps/xiaofang/xuexi`，所以也要在上面两个程序目录中定义好xuexi目录。除此之外，还分别为这3个虚拟主机定义了日志，它们的路径为相对路径logs，相对于`$CATALINA_HOME`。
</code></pre></div><p>再提供 appBase 目录和 docBase 目录。</p> <blockquote><p>mkdir -p /www/longshuai/xuexi</p> <p>mkdir -p /usr/local/tomcat/webapps/xiaofang/xuexi</p></blockquote> <p>再提供测试用的 index.jsp 文件。内容大致如下，分别复制到以下四个目录中：</p> <blockquote><p>/www/longshuai/
/www/longshuai/xuexi/
/usr/local/tomcat/webapps/xiaofang/
/usr/local/tomcat/webapps/xiaofang/xuexi</p></blockquote> <p>并将 out.println 的输出内容分别稍作修改，使能够区分读取的是哪个 index.jsp。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;%@ page language=&quot;java&quot; %&gt;
&lt;%@ page import=&quot;java.util.*&quot; %&gt;
&lt;html&gt;
  &lt;body&gt;
    &lt;% out.println(&quot;hello world from longshuai Root&quot;); %&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>最后重启 catalina。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>catalina.sh stop
catalina.sh start
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>再测试主机上添加 www.{longshuai,xiaofang}.com 的 host 记录。例如在 windows 上，在 C:\Windows\System32\drivers\etc\hosts 中添加如下记录：</p> <p><code>192.168.100.22 www.longshuai.com www.xiaofang.com</code></p> <p>在浏览器中进行测试，结果如下：
<img src="http://md7.admin4j.com/blog/202303281339109.png" alt="image-20201201171554865"></p> <h1 id="_2-tomcat-体系结构基本说明"><a href="#_2-tomcat-体系结构基本说明" class="header-anchor">#</a> 2. tomcat 体系结构基本说明</h1> <p>如下两图：上面的图是 tomcat 组件体系的简图，下面的图是 Service 组件细化后的图。</p> <p><img src="http://md7.admin4j.com/blog/202303281339058.png" alt="img"></p> <p>tomcat 高度模块化，各个模块之间有嵌套的父子关系。如果使用配置文件来描述，可以大致简化为如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;server&gt;
    &lt;service&gt;
        &lt;connector PORT /&gt;
        &lt;engine&gt;
            &lt;host name=www.a.com appBase=/www/a &gt;
                &lt;context path=&quot;&quot; docBase=/www/a /&gt;
                &lt;context path=&quot;/xuexi&quot; docBase=/www/a/xuexi /&gt;
            &lt;/host&gt;

            &lt;host&gt;
                &lt;context /&gt;
            &lt;/host&gt;
        &lt;/engine&gt;
    &lt;/service&gt;
&lt;/server&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>其中：</p> <blockquote><ol><li><p><code>server</code>组件是管理 tomcat 实例的组件，可以监听一个端口，从此端口上可以远程向该实例发送 shutdown 关闭命令。</p></li> <li><p><code>service</code>组件是一个逻辑组件，用于绑定 connector 和 container，有了 service 表示可以向外提供服务，就像是一般的 daemon 类服务的 service。可以认为一个 service 就启动一个 JVM，更严格地说，一个 engine 组件才对应一个 JVM(定义负载均衡时，jvmRoute 就定义在 Engine 组件上用来标识这个 JVM)，只不过 connector 也工作在 JVM 中。</p></li> <li><p><code>connector</code>组件是 监听组件，它有四个作用：</p></li></ol> <ul><li>(1).开启监听套接字，监听外界请求，并和客户端建立 TCP 连接;</li> <li>(2).使用 protocolHandler 解析请求中的协议和端口等信息，如 http 协议、AJP 协议;</li> <li>(3).根据解析到的信息，使用 processer 将分析后的请求转发给绑定的 Engine;</li> <li>(4).接收响应数据并返回给客户端。</li></ul> <ol start="4"><li><p><code>container</code>是容器，它是一类组件，在配置文件(如 server.xml)中没有体现出来。它包含 4 个容器类组件：engine 容器、host 容器、context 容器和 wrapper 容器。</p></li> <li><p><code>engine</code>容器用于从 connector 组件处接收已建立的 TCP 连接，还用于接收客户端发送的 http 请求并分析请求，然后按照分析的结果将相关参数传递给匹配出的虚拟主机。engine 还用于指定默认的虚拟主机。</p></li> <li><p><code>host</code>容器定义虚拟主机，由于 tomcat 主要是作为 servlet 容器的，所以为每个 webapp 指定了它们的根目录 appBase。</p></li> <li><p><code>context</code>容器主要是根据 path 和 docBase 获取一些信息，将结果交给其内的 wrapper 组件进行处理(它提供 wrapper 运行的环境，所以它叫上下文 context)。一般来说，都采用默认的标准 wrapper 类，因此在 context 容器中几乎不会出现 wrapper 组件。</p></li> <li><p><code>wrapper</code>容器对应 servlet 的处理过程。它开启 servlet 的生命周期，根据 context 给出的信息以及解析 web.xml 中的映射关系，负责装载相关的类，初始化 servlet 对象 init()、执行 servlet 代码 service()以及服务结束时 servlet 对象的销毁 destory()。</p></li> <li><p><code>executor</code> 组件为每个 Service 组件提供线程池，<font color="red">使得各个 connector 和 Engine 可以从线程池中获取线程处理请求(connector)</font>，从而实现 tomcat 的并发处理能力。<font color="red">一定要注意，Executor 的线程池大小是为 Engine 组件设置，而不是为 Connector 设置的，Connector 的线程数量由 Connector 组件的 acceptorThreadCount 属性来设置。</font>如果要在配置文件中设置该组件，则必须设置在 Connector 组件的前面，以便在 Connector 组件中使用<code>executor</code>属性来引用配置好的 Executor 组件。如果不显式设置，则采用 Connector 组件上的默认配置，默认配置如下：</p> <ul><li>(1). maxThreads：最大线程数，默认值 200。</li> <li>(2). minSpareThreads：最小空闲线程数，默认值 25。</li> <li>(3). maxIdleTime：空闲线程的线程空闲多长时间才会销毁，默认值 60000 即 1 分钟。</li> <li>(4). prestartminSpareThreads：是否启动 executor 时就直接创建等于最小空闲线程数的线程，默认值为 false，即只在有连接请求进入时才会创建。</li></ul></li></ol></blockquote> <p>根据上面描述的 tomcat 组件体系结构，处理请求的大致过程其实很容易推导出来：</p> <p><code>Client(request)--&gt;Connector--&gt;Engine--&gt;Host--&gt;Context--&gt;Wrapper(response data)--&gt;Connector(response header)--&gt;Client</code></p> <p>撇开 tomcat 作为 servlet 容器的行为。它和 apache、nginx 的功能大致都能对应上。例如以 nginx 为例，以下是 nginx 提供 web 服务时的配置结构：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>server {
    listen PORT;
    server_name www.a.com;   # 对应于&lt;host name=www.a.com&gt;
    location / {             # 对应于context path=&quot;&quot;
            root   html;     # 对应于docBase
        }
    location /xuexi {        # 对应于context path=&quot;/xuexi&quot;
            root   html/xuexi;
        }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="language- extra-class"><pre><code>	connetcor组件类似于nginx的listen指令。host容器类似于nginx的server指令，host容器中的name属性相当于nginx的server_name指令。engine组件则没有对应配置项，不过在nginx同样有engine的功能，例如默认的虚拟主机，分析URL来判断请求交给哪个虚拟主机处理等。context容器相当于location指令，context容器的path属性相当于location的uri匹配路径，docBase相当于location的中的root指令，即DocumentRoot。

	tomcat作为简单的web服务程序大致如此，但它的核心毕竟是处理servlet和jsp，它必须得管理好每个webapp。因此，对于tomcat来说，必须要掌握部署webapp的方式。在tomcat上部署webapp时，必须要理解context的概念。&lt;font color=red&gt;对于tomcat而言，**每个context都应该算是一个webapp，其路径由docBase决定，该目录存放的是归档的war文件或未归档的webapp相关文件，而host容器中的appBase则是虚拟主机整理webapp的地方，一个appBase下可以有多个webapp，即多个context**。&lt;/font&gt;
</code></pre></div><h1 id="_3-tomcat-的-appbase-和-docbase-详细说明"><a href="#_3-tomcat-的-appbase-和-docbase-详细说明" class="header-anchor">#</a> 3. tomcat 的 appBase 和 docBase 详细说明</h1> <p>这两货虽然意义很明确，但&quot;潜规则&quot;很严重。以下面的配置为例。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;host name=www.a.com appBase=/www/a &gt;
    &lt;context path=&quot;&quot; docBase=/www/a /&gt;
    &lt;context path=&quot;/xuexi&quot; docBase=/www/a/xuexi /&gt;
&lt;/host&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>appBase 是虚拟主机存放 webapp 的目录，它可以是相对路径，也可以是绝对路径。如果是相对路径，则相对于**<code>$CATALINA_HOME</code>**，严格并准确地说是$CATALINA_BASE。</p> <ul><li><p>path 是 URI 的匹配路径，相当于 nginx 的 location 后的路径。tomcat 要求每个虚拟主机<strong>必须配置一个空字符串的 path</strong>，该条 context 作为 URI 无法被明确匹配时的默认 context，它相当于 nginx 中<code>location / {}</code>的作用。</p></li> <li><p>docBase 则是每个 webapp 的存放目录(或者是已归档的 war 文件)，它可以是相对路径，也可以是绝对路径，提供相对路径时它相对于 appBase。该目录一般在 appBase 的目录下，但并不规定一定要放在 appBase 下。对于 web 服务来说，它相当于 nginx 的 root 指令，但对于 webapp 来说，一个 context 就相当于一个 webapp，而 docBase 正是 webapp 的路径。</p></li></ul> <p>&quot;潜规则&quot;在于默认的 context 如何提供。有以下几种情况：</p> <ol><li>明确定义了<code>&lt;context path=&quot;&quot; docBase=webappPATH&gt;</code>，此时默认 context 的处理路径为 webappPATH。</li> <li>明确定义了<code>&lt;context path=&quot;&quot;&gt;</code>，但却没给定 docBase 属性，此时该默认 context 处理路径为 appBase/ROOT 目录，注意 ROOT 为大写。</li> <li>完全没有定义<code>path=&quot;&quot;</code>的 context 时，即 host 容器中没有明确的 path=&quot;&quot;，此时将隐式定义一个默认 context，处理路径为 appBase/ROOT 目录。</li> <li>定义了 path 但没有定义 docBase 属性时，docBase 将根据 path 推断出它的路径。推断的规则如下：(注：此时推断的不是默认 context，而是对应 context 的 docbase)</li></ol> <div class="language- line-numbers-mode"><pre class="language-text"><code>context path    context name    推断出的docBase路径
--------------------------------------------------
/foo            /foo            foo
/foo/bar        /foo/bar        foo/bar
Empty String    Empty String    ROOT
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>显然，没有给定 path=&quot;&quot;或缺少 docbase 时，都以 ROOT 作为目录。以下是几个定义示例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code># 虚拟主机中没有定义任何context，将以appBase下的ROOT作为默认处理路径
&lt;Host appBase=&quot;webapps&quot;&gt;
&lt;/Host&gt;

# 没有定义path=&quot;&quot;的context，但定义了path非空的context，也将以ROOT作为默认处理路径
# 如果下面的Context容器中省略docBase属性，则推断出该context的docBase路径为appBase/xuexi
&lt;Host appBase=&quot;webapps&quot;&gt;
    &lt;Context path=&quot;/xuexi&quot; docBase=&quot;webappPATH&quot; /&gt;
&lt;/Host&gt;

# 某个context定义了path=&quot;&quot;，该context将作为默认context
# 但该默认context如果没有定义docBase，将推断出其docBase路径为appBase/ROOT
&lt;Host appBase=&quot;webapps&quot;&gt;
    &lt;Context path=&quot;&quot; docBase=&quot;webappPATH&quot; /&gt;
&lt;/Host&gt;

# 某个context定义了path=&quot;&quot;，该context将作为默认context
# 下面的默认context明确定义了docBase
&lt;Host appBase=&quot;webapps&quot;&gt;
    &lt;Context path=&quot;&quot; docBase=&quot;webappPATH&quot; /&gt;
&lt;/Host&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>举个直观的例子，如果某个 Host 配置如下。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;Host name=&quot;www.xiaofang.com&quot; appBase=&quot;/www/xiaofang&quot; unpackWARs=&quot;true&quot; autoDeploy=&quot;true&quot;&gt;
    &lt;Context path=&quot;/xuexi&quot; docBase=&quot;xuexi&quot; reloadable=&quot;true&quot; /&gt;
&lt;/Host&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>那么浏览器访问<code>http://www.xiaofang.com:8080/xuexi/</code>将请求<code>/www/xiaofang/xuexi/index.jsp</code>。</p> <p>由于没有定义 path=&quot;&quot;的 Context 组件，因此浏览器访问<code>http://www.xiaofang.com:8080</code>将请求/<code>www/xiaofang/ROOT/index.jsp</code>。注意，是 ROOT 目录。</p> <p>如果加上<code>&lt;Context path=&quot;&quot; docBase=&quot;&quot; reloadable=&quot;true&quot; /&gt;</code>，则访问<code>http://www.xiaofang.com:8080</code>将请求<code>/www/xiaofang/index.jsp</code>。注意，不是 ROOT 目录，而是相对于 appBase 的根目录，即/www/xiaofang。</p> <p>尽管本文解释了一大堆关于 appBase 和 docBase 的设置，但一般都会采用大众所熟知的配置方式：<strong>appBase 设置为&quot;webapps&quot;，即<code>$CATALINA_HOME/webapps</code>，而 docBase 设置为 webapps 下的 webapp 应用名</strong>。这样配置不仅符合 eclipse 部署 webapp 时默认的部署目录结构(eclipse 部署应用时，将 WebContent 下的内容复制到 docBase 下，将 servlet java 源代码编译后的 class 文件复制到 WEB-INF/classes 目录下)，更利于维护 webapp 和相关配置。例如：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;Context docBase=&quot;MyWeb&quot; path=&quot;/MyWeb&quot; reloadable=&quot;true&quot; /&gt;
&lt;Context docBase=&quot;SecondWeb&quot; path=&quot;/SecondWeb&quot; reloadable=&quot;true&quot; /&gt;
&lt;Context docBase=&quot;WEB&quot; path=&quot;/WEB&quot; reloadable=&quot;true&quot; /&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>但这样的配置有个缺点，因为项目名称一般都会带有大写字母，使得在浏览器访问时，也要带有大写字母。例如输入<code>http://www.a.com/MyWeb/index.jsp</code>。因此，可采用另一种配置方式：设置 Host 的 appBase 为 webapps 下的某个目录，然后在 path 上配置 uri 匹配路径。如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;Host name=&quot;www.xiaofang.com&quot; appBase=&quot;webapps/MyWeb&quot; unpackWARs=&quot;true&quot; autoDeploy=&quot;true&quot;&gt;
    &lt;Context path=&quot;/xuexi&quot; docBase=&quot;xuexi&quot; reloadable=&quot;true&quot; /&gt;
    &lt;Context path=&quot;&quot; docBase=&quot;&quot; reloadable=&quot;true&quot; /&gt;
&lt;/Host&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h1 id="_4-webapp-目录体系结构"><a href="#_4-webapp-目录体系结构" class="header-anchor">#</a> 4. webapp 目录体系结构</h1> <p>webapp 有特定的组织格式，是一种层次型目录结构，通常包含了 servlet 代码文件、jsp 页面文件、类文件、部署描述符文件等等。</p> <p>这些文件可能是以目录的形式存放，也可能会打包成各种归档格式的文件，如 jar、war 等。但 jsp 有规定，在 web 应用程序的根目录下，一般要有下面几个目录：</p> <ul><li>/WEB-INF：此 webapp 的私有资源目录，从浏览器上是无法访问此目录资源的，通常 web.xml 放置于此目录</li> <li>/WEB-INF/classes：此 webapp 自有的类</li> <li>/WEB-INF/lib：此 webapp 自有能够打包为 jar 格式的类</li> <li>/META-INF：并非标准的 webapp 目录，有的应用程序才有。当该应用程序想独立定义自己的 context.xml 时可放入此目录，也是私有目录。</li></ul> <p>每个 webapp 要想被 tomcat 加载，一种方法是程序目录放在$catalina.home/webapps下，另一种方式是配置该webapp相关的context配置，使tomcat能找到此webapp。正如前文所说，webapp目录一般都会放在$catalina.home/webapps 下。</p> <p>简单部署示例：</p> <ul><li><p>(1)对于 war 类归档程序：将归档文件复制到$CATALINA_BASE/webapps/目录中，并重启 tomcat 即可，tomcat 会自动展开 war 归档。例如官方提供了一个 sample.war 作为 tomcat 学习初级示例( https://tomcat.apache.org/tomcat-8.5-doc/appdev/sample/sample.war )，下载后只需将其放入 webapps 下即可。</p></li> <li><p>(2)在测试 tomcat 的过程中，很多时候是未归档程序，这时可以手动创建目录来实现部署。需要创建的目录有 webapps/yourapp，此目录下还要创建 WEB-INF 目录，在 WEB-INF 目录中还要创建 classes 和 lib 目录。然后将 jsp 文件放在对应目录下即可，如写一个测试的 index.jsp 放在 yourapp 目录下。而对于已经开发完毕的 webapp，因为 idea 在打包发布测试 webapp 时已经设置好目录，因此只要将 webapp 的目录复制到 webapps 目录下即可。</p></li></ul> <h1 id="_5-tomcat-配置文件-server-xml-详解"><a href="#_5-tomcat-配置文件-server-xml-详解" class="header-anchor">#</a> 5. tomcat 配置文件 server.xml 详解</h1> <div class="language- extra-class"><pre><code>	tomcat配置文件中配置的是各个组件的属性，**全局**配置文件为`$CATALINA_HOME/conf/server.xml`，主要的组件有以下几项：Server,Service,Connector,Engine,Host,Alias,Context,Valve等。配置完配置文件后需要重启tomcat，但在启动后一定要检查tomcat是否启动成功，因为即使出错，很多时候它都不会报错，可从监听端口判断。
</code></pre></div><p>配置方法见<a href="http://tomcat.apache.org/tomcat-8.5-doc/config/index.html" target="_blank" rel="noopener noreferrer">官方手册<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，在页面的左边有各个组件的链接。</p> <p>tomcat 的配置文件都是 xml 文件，以下是 xml 文件的常见规则：</p> <ul><li><ol><li>文件第一行设置 xml 标识，表示该文件是 xml 格式的文件。例如<code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</code>。</li></ol></li> <li><ol start="2"><li>xml 文件的注释方法为<code>&lt;!-- XXX --&gt;</code>，这可以是单行注释，也可以多行注释，只要前后注释符号能对应上，中间的内容都是注释。</li></ol></li> <li><ol start="3"><li>定义属性时有两种方式：单行定义和多行定义。例如：</li></ol></li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;NAME key=value /&gt;

&lt;!-- 多行定义的方式 --&gt;
&lt;NAME key=value&gt;
&lt;/NAME&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language- extra-class"><pre><code>	下面个组件的配置中有些地方使用了相对于`$CATALINA_BASE`的相对路径，它和`$CATALINA_HOME`小有区别。如果只有一个tomcat实例，则它们是等价的，都是tomcat的安装路径。如果有多个tomcat实例，则`$CATALINA_HOME`表示的是安装路径，而`$CATALINA_BASE`表示的是各实例所在根目录。关于tomcat多实例，见[running.txt](http://tomcat.apache.org/tomcat-8.5-doc/RUNNING.txt)中对应的说明
</code></pre></div><h2 id="_5-1-顶级元素-server"><a href="#_5-1-顶级元素-server" class="header-anchor">#</a> 5.1 顶级元素 server</h2> <p>server 组件定义的是一个 tomcat 实例。默认定义如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;Server port=&quot;8005&quot; shutdown=&quot;SHUTDOWN&quot;&gt;
&lt;/Server&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language- extra-class"><pre><code>	它默认监听在8005端口以接收shutdown命令。要启用多个tomcat实例，将它们监听在不同的端口即可。这个端口的定义为管理员提供一个关闭实例的便捷途径，可以直接telnet至此端口使用SHUTDOWN命令关闭此实例。不过基于安全角度的考虑，通常不允许远程进行。
</code></pre></div><blockquote><p>Server 的相关属性：</p></blockquote> <ul><li><code>className</code>：用于实现此组件的 java 类的名称，这个类必须实现接口 org.apache.catalina.Server。不给定该属性时将采用默认的标准类 org.apache.catalina.core.StandardServer；</li> <li><code>address</code>：监听端口绑定的地址。如不指定，则默认为 Localhost，即只能在 localhost 上发送 SHUTDOWN 命令；</li> <li><code>port</code>：接收 shutdown 指令的端口，默认仅允许通过本机访问，默认为 8005；</li> <li><code>shutdown</code>：通过 TCP/IP 连接发往此 Server 用于实现关闭 tomcat 实例的命令字符串。</li></ul> <p>在 server 组件中可嵌套一个或多个 service 组件。</p> <h2 id="_5-2-顶级元素-service"><a href="#_5-2-顶级元素-service" class="header-anchor">#</a> 5.2 顶级元素 service</h2> <p>定义了 service 就能提供服务了。service 组件中封装 connector 和 container，它同时也表示将此 service 中的 connector 和 container 绑定起来，即由它们组成一个 service 向外提供服务。默认定义如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;Service name=&quot;Catalina&quot;&gt;
&lt;/Service&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Service 相关的属性：</p> <ul><li><code>className</code>：用于实现 service 的类名，这个类必须实现 org.apache.catalina.Service 接口。不给定该属性时将采用默认的标准类 org.apache.catalina.core.StandardService。</li> <li><code>name</code>：此 service 的显示名称，该名称主要用于在日志中进行标识 service。一般来说无关紧要，默认为 Catalina。</li></ul> <h2 id="_5-3-执行器-executor"><a href="#_5-3-执行器-executor" class="header-anchor">#</a> 5.3 执行器 executor</h2> <div class="language- extra-class"><pre><code>	执行器定义tomcat各组件之间共享的线程池。在以前，每个connector都会独自创建自己的线程池，但现在，可以定义一个线程池，各组件都可以共享该线程池，不过主要是为各connector之间提供共享。注意，&lt;font color='red'&gt;**executor创建的是共享线程池，如果某个connector不引用executor创建的线程池，那么该connector仍会根据自己指定的属性创建它们自己的线程池**。&lt;/font&gt;

	连接器必须要实现org.apache.catalina.Executor接口。它是一个嵌套在service组件中的元素，为了挑选所使用的connector，该元素还必须定义在connector元素之前。
</code></pre></div><p>默认的定义如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;Executor name=&quot;tomcatThreadPool&quot; namePrefix=&quot;catalina-exec-&quot;
    maxThreads=&quot;150&quot; minSpareThreads=&quot;4&quot;/&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><blockquote><p>其中该组件的属性有：</p></blockquote> <ul><li><code>className</code>：用于实现此组件的 java 类的名称，这个类必须实现接口 org.apache.catalina.Executor。不给定该属性时将采用默认的标准类 org.apache.catalina.core.StandardThreadExecutor；</li> <li><code>name</code>：该线程池的名称，其他组件需要使用该名称引用该线程池。</li></ul> <p>标准类的属性包括：</p> <ul><li><code>threadPriority</code>：线程优先级，默认值为 5。</li> <li><code>daemon</code>：线程是否以 daemon 的方式运行，默认值为 true。</li> <li><code>namePrefix</code>：执行器创建每个线程时的名称前缀，最终线程的名称为:namePrefix+threadNumber。</li> <li><code>maxThreads</code>：线程池激活的最大线程数量。默认值为 200。</li> <li><code>minSpareThreads</code>：线程池中最少空闲的线程数量。默认值为 25。</li> <li><code>maxIdleTime</code>：在空闲线程关闭前的毫秒数。除非激活的线程数量小于或等于 minSpareThreads 的值，否则会有空闲线程的出现。默认值为 60000，即空闲线程需要保留 1 分钟的空闲时间才被杀掉。</li> <li><code>maxQueueSize</code>：可执行任务的最大队列数，达到队列上限时的连接请求将被拒绝。</li> <li><code>prestartminSpareThreads</code>：在启动 executor 时是否立即创建 minSpareThreads 个线程数，默认为 false，即在需要时才创建线程。</li></ul> <p>例如在 connector 中指定所使用的线程池，方式如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;Connector executor=&quot;tomcatThreadPool&quot;
           port=&quot;8080&quot; protocol=&quot;HTTP/1.1&quot;
           connectionTimeout=&quot;20000&quot;
           redirectPort=&quot;8443&quot; /&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="_5-4-连接器-connector"><a href="#_5-4-连接器-connector" class="header-anchor">#</a> 5.4 连接器 connector</h2> <div class="language- extra-class"><pre><code>	连接器用于**接收客户端发送的请求并返回响应给客户端**。一个service中可以有多个connector。有多种connector，常见的为http/1.1,http/2和ajp(apache jserv protocol)。在tomcat中，ajp连接协议类型专用于tomcat前端是apache反向代理的情况下。
</code></pre></div><p>因此 tomcat 可以扮演两种角色：</p> <ul><li>Tomcat 仅作为应用程序服务器：请求来自于前端的 web 服务器，这可能是 Apache, IIS, Nginx 等；</li> <li>Tomcat 既作为 web 服务器，也作为应用程序服务器：请求来自于浏览器。</li></ul> <p>Tomcat 应该考虑工作情形并为相应情形下的请求<strong>分别定义</strong>好需要的连接器才能正确接收来自于客户端的请求。</p> <p>此处暂先介绍 HTTP/1.1 连接器的属性设置。ajp 后文再做介绍。</p> <p>HTTP 连接器表示支持 HTTP/1.1 协议的组件。设置了该连接器就表示 catalina 启用它的独立 web 服务功能，当然，肯定也提供它必须的 servlets 和 jsp 执行功能。在一个 service 中可以配置一个或多个连接器，每个连接器都可以将请求转发给它们相关联的 engine 以处理请求、创建响应。</p> <p><strong>每个流入的请求都需要一个独立的线程来接收</strong>。当并发请求数量超出 maxThreads 指定的值时，多出的请求将被堆叠在套接字中，直到超出 acceptCount 指定的值。超出 accpetCount 的请求将以&quot;connection refused&quot;错误进行拒绝。</p> <p>默认的定义如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;Connector port=&quot;8080&quot; protocol=&quot;HTTP/1.1&quot;
           connectionTimeout=&quot;20000&quot;
           redirectPort=&quot;8443&quot; /&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>HTTP 连接器的属性实在太多，详细配置方法见<a href="http://tomcat.apache.org/tomcat-8.5-doc/config/http.html" target="_blank" rel="noopener noreferrer">官方手册<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。通常定义 HTTP 连接器时必须定义的属性只有&quot;port&quot;。</p> <ul><li><code>address</code>：指定连接器监听的地址，默认为所有地址，即 0.0.0.0。</li> <li><code>maxThreads</code>：支持的最大并发连接数，默认为 200；如果引用了 executor 创建的共享线程池，则该属性被忽略。</li> <li><code>acceptCount</code>：设置等待队列的最大长度；通常在 tomcat 所有处理线程均处于繁忙状态时，新发来的请求将被放置于等待队列中；</li> <li><code>maxConnections</code>：允许建立的最大连接数。acceptCount 和 maxThreads 是接受连接的最大线程数。存在一种情况，maxConnections 小于 acceptCount 时，超出 maxConnections 的连接请求将被接收，但不会与之建立连接。</li> <li><code>port</code>：监听的端口，默认为 0，此时表示随机选一个端口，通常都应该显式指定监听端口。</li> <li><code>protocol</code>：连接器使用的协议，用于处理对应的请求。默认为 HTTP/1.1，此时它会自动在基于 Java NIO 或 APR/native 连接器之间进行切换。定义 AJP 协议时通常为 AJP/1.3。</li> <li><code>redirectPort</code>：如果某连接器支持的协议是 HTTP，当接收客户端发来的 HTTPS 请求时，则转发至此属性定义的端口。</li> <li><code>connectionTimeout</code>：等待客户端发送请求的超时时间，单位为毫秒，默认为 60000，即 1 分钟；注意，这时候连接已经建立。</li> <li><code>keepAliveTimeout</code>：长连接状态的超时时间。超出该值时，长连接将关闭。</li> <li><code>enableLookups</code>：是否通过 request.getRemoteHost()进行 DNS 查询以获取客户端的主机名；默认为 true，应设置为 false 防止反解客户端主机；</li> <li><code>compression</code>：是否压缩数据。默认为 off。设置为 on 时表示只压缩 text 文本，设置为 force 时表示压缩所有内容。应该在压缩和 sendfile 之间做个权衡。</li> <li><code>useSendfile</code>：该属性为 NIO 的属性，表示是否启用 sendfile 的功能。默认为 true，启用该属性将会禁止 compression 属性。</li></ul> <p>当协议指定为 HTTP/1.1 时，默认会自动在 NIO/APR 协议处理方式上进行按需切换。如要显式指定协议，方式如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;connector port=&quot;8080&quot; protocol=&quot;HTTP/1.1&quot;&gt;
&lt;connector port=&quot;8080&quot; protocol=&quot;org.apache.coyote.http11.Http11NioProtocol&quot;&gt;
&lt;connector port=&quot;8080&quot; protocol=&quot;org.apache.coyote.http11.Http11Nio2Protocol&quot;&gt;
&lt;connector port=&quot;8080&quot; protocol=&quot;org.apache.coyote.http11.Http11AprProtocol&quot;&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>其中 NIO 是 C/C++的非阻塞 IO 复用模型在 JAVA 中的 IO 实现，NIO2 即 AIO 是异步 NIO，即异步非阻塞 IO：
NioProtocol ：non blocking Java NIO connector
Nio2Protocol：non blocking Java NIO2 connector
AprProtocol ：the APR/native connector
它们之间的异同点如下表所示：</p> <table><thead><tr><th></th> <th>Java Nio Connector</th> <th>Java Nio2 Connector</th> <th>APR/native Connector</th></tr></thead> <tbody><tr><td>Classname</td> <td>Http11NioProtocol</td> <td>Http11Nio2Protocol</td> <td>Http11AprProtocol</td></tr> <tr><td>Tomcat Version</td> <td>6.x onwards</td> <td>8.x onwards</td> <td>5.5.x onwards</td></tr> <tr><td>Support Polling</td> <td>YES</td> <td>YES</td> <td>YES</td></tr> <tr><td>Polling Size</td> <td>maxConnections</td> <td>maxConnections</td> <td>maxConnections</td></tr> <tr><td>Read Request Headers</td> <td>Non Blocking</td> <td>Non Blocking</td> <td>Non Blocking</td></tr> <tr><td>Read Request Body</td> <td>Blocking</td> <td>Blocking</td> <td>Blocking</td></tr> <tr><td>Write Response Headers and Body</td> <td>Blocking</td> <td>Blocking</td> <td>Blocking</td></tr> <tr><td>Wait for next Request</td> <td>Non Blocking</td> <td>Non Blocking</td> <td>Non Blocking</td></tr> <tr><td>SSL Support</td> <td>Java SSL or OpenSSL</td> <td>Java SSL or OpenSSL</td> <td>OpenSSL</td></tr> <tr><td>SSL Handshake</td> <td>Non blocking</td> <td>Non blocking</td> <td>Blocking</td></tr> <tr><td>Max Connections</td> <td>maxConnections</td> <td>maxConnections</td> <td>maxConnections</td></tr></tbody></table> <p>下面是一个定义了多个属性的 SSL 连接器：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;Connector port=&quot;8443&quot;
    maxThreads=&quot;150&quot; minSpareThreads=&quot;25&quot; maxSpareThreads=&quot;75&quot;
    enableLookups=&quot;false&quot; acceptCount=&quot;100&quot; debug=&quot;0&quot; scheme=&quot;https&quot; secure=&quot;true&quot;
    clientAuth=&quot;false&quot; sslProtocol=&quot;TLS&quot; /&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="_5-5-容器类-engine"><a href="#_5-5-容器类-engine" class="header-anchor">#</a> 5.5 容器类 engine</h2> <p>engine 是 service 组件中用来分析协议的引擎机器，<font color="red"><strong>它从一个或多个 connector 上接收请求，并将请求交给对应的虚拟主机进行处理，最后返回完整的响应数据给 connector，通过 connector 将响应数据返回给客户端。</strong></font></p> <p>只有一个 engine 元素必须嵌套在每个 service 中，且 engine 必须在其所需要关联的 connector 之后，这样在 engine 前面的 connector 都可以被此 engine 关联，而在 engine 后面的 connector 则被忽略，因为一个 service 中只允许有一个 engine。</p> <p>定义方式大致如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;Engine name=&quot;Catalina&quot; defaultHost=&quot;localhost&quot;&gt;
&lt;/Engine&gt;

&lt;Engine name=&quot;Standalone&quot; defaultHost=&quot;localhost&quot; jvmRoute=&quot;TomcatA&quot;&gt;
&lt;/Engine&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>常用的 engine 属性有：</p> <ul><li><code>className</code>：实现 engine 的类，该类必须实现 org.apache.catalina.Engine 接口。不给定该属性时将采用默认的标准类 org.apache.catalina.core.StandardEngine。</li> <li><code>defaultHost</code>：指定处理请求的默认虚拟主机。在 Engine 中定义的多个虚拟主机的主机名称中至少有一个跟 defaultHost 定义的主机名称同名。</li> <li><code>name</code>：Engine 组件的名称，用于记录日志和错误信息，无关紧要的属性，可随意给定。</li> <li><code>jvmRoute</code>：在启用 session 粘性时指定使用哪种负载均衡的标识符。所有的 tomcat server 实例中该标识符必须唯一，它会追加在 session 标识符的尾部，因此能让前端代理总是将特定的 session 转发至同一个 tomcat 实例上。</li> <li>注意，jvmRoute 同样可以使用 jvmRoute 的系统属性来设置。如果此处设置了 jvmRoute，则覆盖 jvmRoute 系统属性。关于 jvmRoute 的使用，在后面 tomcat ajp 负载均衡的文章中介绍。</li></ul> <p>engine 是容器中的顶级子容器，其内可以嵌套一个或多个 Host 作为虚拟主机，且至少一个 host 要和 engine 中的默认虚拟主机名称对应。除了 host，还可以嵌套 releam 和 valve 组件。</p> <h2 id="_5-6-容器类-host"><a href="#_5-6-容器类-host" class="header-anchor">#</a> 5.6 容器类 host</h2> <p>host 容器用来定义虚拟主机。engine 从 connector 接收到请求进行分析后，会将相关的属性参数传递给对应的(筛选方式是从请求首部的 host 字段和虚拟主机名称进行匹配)虚拟 host 进行处理。如果没有合适的虚拟主机，则传递给默认虚拟主机。因此每个容器中必须至少定义一个虚拟主机，且必须有一个虚拟主机和 engine 容器中定义的默认虚拟主机名称相同。</p> <p>大致定义方式如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;Host name=&quot;localhost&quot;  appBase=&quot;webapps&quot;
            unpackWARs=&quot;true&quot; autoDeploy=&quot;true&quot;&gt;
&lt;/Host&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>常用属性说明：</p> <ul><li><code>className</code>：实现 host 容器的类，该类必须实现 org.apache.catalina.Host 接口。不给定该属性时将采用默认的标准类 org.apache.catalina.core.StandardHost。</li> <li><code>name</code>：虚拟主机的主机名，忽略大小写(初始化时会自动转换为小写)。可以使用前缀星号通配符，如&quot;*.a.com&quot;。使用了星号前缀的虚拟主机的匹配优先级低于精确名称的虚拟主机。</li> <li><code>appBase</code>：此 Host 的 webapps 目录，即 webapp 部署在此虚拟主机上时的存放目录。包括非归档的 web 应用程序目录和归档后的 WAR 文件的目录。使用相对路径时基于$CATALINA_BASE。</li> <li><code>xmlBase</code>：部署在此虚拟主机上的 context xml 目录。</li> <li><code>startStopThreads</code>：启动 context 容器时的并行线程数。如果使用了自动部署功能，则再次部署或更新时使用相同的线程池。</li> <li><code>autoDeploy</code>：在 Tomcat 处于运行状态时放置于 appBase 目录中的应用程序文件是否自动进行 deploy 或自动更新部署状态。这等于同时开启了 deployOnStartup 属性和 reload/redeploy webapp 的功能。触发自动更新时将默认重载该 webapp。默认为 true。</li> <li><code>unpackWars</code>：在执行此 webapps 时是否先对归档格式的 WAR 文件解压再运行，设置为 false 时则直接执行 WAR 文件；默认为 true。设置为 false 时会损耗性能。</li> <li><code>workDir</code>：该虚拟主机的工作目录。每个 webapp 都有自己的临时 IO 目录，默认该工作目录为$CATALINA_BASE/work。</li></ul> <p>大多数时候都只需设置虚拟主机名称 name 和 appBase 属性即可，其余采用默认，默认时会自动部署 webapp。有时候还需要管理多个站点名称，即主机别名。可以使用 Alias 为 Host 指定的主机名定义主机别名。如：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;Host name=&quot;web.a.com&quot; appBase=&quot;webapps&quot; unpackWARs=&quot;true&quot;&gt;
  &lt;Alias&gt;www.a.com&lt;/Alias&gt;
&lt;/Host&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>自动部署指的是自动装载 webapp 以提供相关 webapp 的服务。</p> <h2 id="_5-7-容器类-context"><a href="#_5-7-容器类-context" class="header-anchor">#</a> 5.7 容器类 context</h2> <div class="language- extra-class"><pre><code>	connector和container是整个tomcat的心脏，而context则是container的心脏，更是tomcat心脏的心脏。它是真正管理servlet的地方，它的配置影响了servlet的工作方式。

	一个context代表一个webapp。servlet中规定，每个webapp都必须基于已归档的WAR(WEB application archive)文件或基于非归档相关内容所在目录。

	catalina基于对请求URI与context中定义的path进行最大匹配前缀的规则进行挑选，从中选出使用哪个context来处理该HTTP请求。这相当于nginx的location容器，catalina的path就相当于location的path，它们的作用是相同的。

	每个context都必须在虚拟主机容器host中有一个唯一的context name。context的path不需要唯一，因为允许同一个webapp不同版本的共存部署。此外，必须要有一个context的path为0长度的字符串(如`&lt;Context path=&quot;&quot; docBase=&quot;ROOT&quot;/&gt;`)，该context是该虚拟主机的默认webapp，用于处理所有无法被虚拟主机中所有context path匹配的请求(当然，不定义也可以，此时将自动隐式提供，见前文所述)。

	关于context name，它是从context path推断出来的，不仅如此，其余几个属性如context basefile name也是由此推断出来的。规则如下：
</code></pre></div><ul><li>如果 path 不为空，则 context name 等于 context path，basefile name 取 path 中去除前缀&quot;/&quot;后的路径，且所有&quot;/&quot;替换为&quot;#&quot;。</li> <li>如果 path 为空，则 context name 也为空，而 basefile 为 ROOT(注意是大写)。</li></ul> <p>例如：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>context path    context name    basefile name     deploy examples
-----------------------------------------------------------------
/foo            /foo            foo               foo.xml,foo.war,foo
/foo/bar        /foo/bar        foo#bar           foo#bar.xml,foo#bar.war,foo#bar
Empty String    Empty String    ROOT              ROOT.xml,ROOT.war,ROOT
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language- extra-class"><pre><code>	配置context时，强烈建议不要定义在server.xml中，因为定义在conf/server.xml中时，只能通过重启tomcat来重载生效，也就是说无法自动部署应用程序了。**虽说官方如此推荐，但大多数人出于习惯和方便，还是会直接写在server.xml中，这并没有什么问题，无非是重启一下而已。**

	可以考虑定义在/META-INF/context.xml中，如果此时设置了copyXML属性，在部署时会将此context.xml复制到$CATALINA_BASE/conf/enginename/hostname/下，并重命名为&quot;basefile name.xml&quot;。也可以直接定义在$CATALINA_BASE/conf/enginename/hostname/下的.xml文件中，该路径的xml优先级高于/META-INF/context.xml。

	还可以定义默认的context.xml文件，包括两种：
</code></pre></div><ul><li>(1)定义在$CATALINA_BASE/conf/context.xml 中，该默认 context 对所有 webapp 都生效；</li> <li>(2)定义在$CATALINA_BASE/conf/[enginename]/[hostname]/context.xml.default 中，该默认 context 只对该虚拟主机中的所有 webapp 生效。</li></ul> <p>定义方式大致如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;Host name=&quot;www.a.com&quot;  appBase=&quot;webapps&quot;
            unpackWARs=&quot;true&quot; autoDeploy=&quot;true&quot;&gt;
      &lt;Context path=&quot;&quot; docBase=&quot;ROOT&quot;/&gt;
      &lt;Context path=&quot;/bbs&quot; docBase=&quot;web/bbs&quot; reloadable=&quot;true&quot;/&gt;
&lt;/Host&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language- extra-class"><pre><code>	其中第一个context的path为空字符串，表示它是默认的context。当浏览器中输入www.a.com时，由于无法匹配第二个context，所以被默认即第一个context处理，当浏览器中输入www.a.com/bbs时，将被第二个context处理，它将执行web/bbs所对应的webapp，并返回相关内容。
</code></pre></div><p>在 context 容器中可以定义非常多的属性，详细内容见<a href="http://tomcat.apache.org/tomcat-8.5-doc/config/context.html#Attributes" target="_blank" rel="noopener noreferrer">官方手册<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，以下是常见的几个属性：</p> <ul><li><code>className</code>：实现 host 容器的类，该类必须实现 org.apache.catalina.Context 接口。不给定该属性时将采用默认的标准类 org.apache.catalina.core.StandardContext。</li> <li><code>cookies</code>：默认为 true，表示启用 cookie 来标识 session。</li> <li><code>docBase</code>：即 DocumentRoot，是该 webapp 的 context root，即归档 WAR 文件所在目录或非归档内容所在目录。可以是绝对路径，也可以是相对于该 webapp appBase 的相对路径。</li> <li><code>path</code>：定义 webapp path。注意，当 path=&quot;&quot;时，表示默认的 context；另外只有在 server.xml 中才需要定义该属性，其他所有情况下都不能定义该属性，因为会根据 docBase 和 context 的 xml 文件名推断出 path。</li> <li><code>reloadable</code>：是否监控/WEB-INF/class 和/WEB-INF/lib 两个目录中文件的变化，变化时将自动重载。在测试环境下该属性很好，但在真实生产环境部署应用时不应该设置该属性，因为监控会大幅增加负载，因此该属性的默认值为 false。</li> <li><code>wrapperClass</code>：实现 wrapper 容器的类，wrapper 用于管理该 context 中的 servlet，该类必须实现 org.apache.catalina.Wrapper 接口，如果不指定该属性则采用默认的标准类。</li> <li><code>xmlNamespaceAware</code>：和 web.xml 的解析方式有关。默认为 true，设置为 false 可以提升性能。</li> <li><code>xmlValidation</code>：和 web.xml 的解析方式有关。默认为 true，设置为 false 可以提升性能。</li></ul> <h2 id="_5-8-被嵌套类-realm"><a href="#_5-8-被嵌套类-realm" class="header-anchor">#</a> 5.8 被嵌套类 realm</h2> <div class="language- extra-class"><pre><code>	realm定义的是一个安全上下文，就像是以哪种方式存储认证时的用户和组相关的数据库。有多种方式可以实现数据存放：
</code></pre></div><ul><li>JAASRealm：基于 Java Authintication and Authorization Service 实现用户认证；</li> <li>JDBCRealm：通过 JDBC 访问某关系型数据库表实现用户认证；</li> <li>JNDIRealm：基于 JNDI 使用目录服务实现认证信息的获取；</li> <li>MemoryRealm：查找 tomcat-user.xml 文件实现用户信息的获取；</li> <li>UserDatabaseRealm：基于 UserDatabase 文件(通常是 tomcat-user.xml)实现用户认证，它实现是一个完全</li> <li>可更新和持久有效的 MemoryRealm，因此能够跟标准的 MemoryRealm 兼容；它通过 JNDI 实现；</li></ul> <p>下面是一个常见的使用 UserDatabase 的配置：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;Realm className=&quot;org.apache.catalina.realm.UserDatabaseRealm&quot;
  resourceName=&quot;UserDatabase&quot;/&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>下面是一个使用 JDBC 方式获取用户认证信息的配置：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;Realm className=&quot;org.apache.catalina.realm.JDBCRealm&quot; debug=&quot;99&quot;
  driverName=&quot;org.gjt.mm.mysql.Driver&quot;
  connectionURL=&quot;jdbc:mysql://localhost/authority&quot;
  connectionName=&quot;test&quot; connectionPassword=&quot;test&quot;
  userTable=&quot;users&quot; userNameCol=&quot;user_name&quot;
  userCredCol=&quot;user_pass&quot;
  userRoleTable=&quot;user_roles&quot; roleNameCol=&quot;role_name&quot; /&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="_5-9-被嵌套类-valve"><a href="#_5-9-被嵌套类-valve" class="header-anchor">#</a> 5.9 被嵌套类 valve</h2> <div class="language- extra-class"><pre><code>	Valve中文意思是阀门，类似于过滤器，它可以工作于Engine和Host/Context之间、Host和Context之间以及Context和Web应用程序的某资源之间。一个容器内可以建立多个Valve，而且Valve定义的次序也决定了它们生效的次序。
</code></pre></div><p>有多种不同的 Valve：</p> <ul><li>AccessLogValve：<strong>访问日志 Valve</strong>；</li> <li>ExtendedAccessValve：扩展功能的访问日志 Valve；</li> <li>JDBCAccessLogValve：通过 JDBC 将访问日志信息发送到数据库中；</li> <li>RequestDumperValve：请求转储 Valve；</li> <li>RemoteAddrValve：<strong>基于远程地址的访问控制</strong>；</li> <li>RemoteHostValve：<strong>基于远程主机名称的访问控制</strong>；</li> <li>SemaphoreValve：用于控制 Tomcat 主机上任何容器上的并发访问数量；</li> <li>JvmRouteBinderValve：在配置多个 Tomcat 为以 Apache 通过 mod_proxy 或 mod_jk 作为前端的集群架构中，当期望停止某节点时，可以通过此 Valve 将用记请求定向至备用节点；使用此 Valve，必须使用 JvmRouteSessionIDBinderListener；</li> <li>ReplicationValve：专用于 Tomcat 集群架构中，可以在某个请求的 session 信息发生更改时触发 session 数据在各节点间进行复制；</li> <li>SingleSignOn：将两个或多个需要对用户进行认证 webapp 在认证用户时连接在一起，即一次认证即可访问所有连接在一起的 webapp；</li> <li>ClusterSingleSingOn：对 SingleSignOn 的扩展，专用于 Tomcat 集群当中，需要结合 ClusterSingleSignOnListener 进行工作；</li></ul> <p>其中 RemoteHostValve 和 RemoteAddrValve 可以分别用来实现基于主机名称和基于 IP 地址的访问控制，控制本身可以通过 allow 或 deny 来进行定义，这有点类似于 Apache 的访问控制功能。如下面的 Valve 实现了仅允许本机访问/probe：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;Context privileged=&quot;true&quot; path=&quot;/probe&quot; docBase=&quot;probe&quot;&gt;
  &lt;Valve className=&quot;org.apache.catalina.valves.RemoteAddrValve&quot;
  allow=&quot;127\.0\.0\.1&quot;/&gt;
&lt;/Context&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>其中相关属性定义有:</p> <ul><li>className：在对应位置的后缀上加上&quot;.valves.RemoteHostValve&quot;或&quot;.valves.RemoteAddrValve&quot;；</li> <li>allow：以逗号分开的允许访问的 IP 地址列表，支持正则，点号“.”用于 IP 地址时需要转义；仅定义 allow 项时，非明确 allow 的地址均被 deny；</li> <li>deny: 以逗号分开的禁止访问的 IP 地址列表，支持正则；使用方式同 allow；仅定义 deny 项时，非明确 deny 的地址均被 allow；</li></ul> <p>另外一个常用的 Valve 为 AccessLogValve，定义方式大致如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;Valve className=&quot;org.apache.catalina.valves.AccessLogValve&quot; directory=&quot;logs&quot;
               prefix=&quot;localhost_access_log&quot; suffix=&quot;.txt&quot;
               pattern=&quot;%h %l %u %t &amp;quot;%r&amp;quot; %s %b&quot; /&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>其中 prefix 和 suffix 表示日志文件的前缀名称和后缀名称。pattern 表示记录日志时的信息和格式。</p></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/andanyang/vuepress-theme-vdoing/edit/master/docs/tomcat/0002.Tomcat(二)：tomcat配置文件server.xml详解和部署简介.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2023/07/13, 12:37:28</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/tomcat-1/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">Tomcat(一)：背景知识和安装tomcat</div></a> <a href="/pages/tomcat-3/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">Tomcat(三)：tomcat处理连接的详细过程</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/tomcat-1/" class="prev">Tomcat(一)：背景知识和安装tomcat</a></span> <span class="next"><a href="/pages/tomcat-3/">Tomcat(三)：tomcat处理连接的详细过程</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/082f7c/"><div>
            高效快捷读写文件之 RandomAccessFile 类解说
            <!----></div></a> <span class="date">07-13</span></dt></dl><dl><dd>02</dd> <dt><a href="/java/file/"><div>
            文件读写操作与常用技巧分享
            <!----></div></a> <span class="date">07-13</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/uniapp/"><div>
            uniApp新模式 - 使用Vue3 + Vite4 + Pinia + Axios技术栈构建
            <!----></div></a> <span class="date">07-10</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:1218853253@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/andanyang" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=755597173" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2019-2023
    <span>Young | <a href="https://github.com/andanyoung/young-blog/blob/master/LICENSE" target="_blank">MIT License</a> <br/> <a  href="https://beian.miit.gov.cn/" target="_blank">浙ICP备20002744号</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.40283726.js" defer></script><script src="/assets/js/2.f3a5e277.js" defer></script><script src="/assets/js/99.54eed138.js" defer></script>
  </body>
</html>
