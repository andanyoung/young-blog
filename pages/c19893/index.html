<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Hadoop（生产调优手册） | Young&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="Young丶java后端技术博客,专注后端学习与总结。擅长spring boot,JAVA基础总结,等方面的知识,关注spring,架构,elasticsearch,mysql领域.">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.d9c8cf8c.css" as="style"><link rel="preload" href="/assets/js/app.b6693791.js" as="script"><link rel="preload" href="/assets/js/2.e72925f9.js" as="script"><link rel="preload" href="/assets/js/3.50ee34d2.js" as="script"><link rel="prefetch" href="/assets/js/10.cdfb498c.js"><link rel="prefetch" href="/assets/js/100.56be6a81.js"><link rel="prefetch" href="/assets/js/101.c3a3e093.js"><link rel="prefetch" href="/assets/js/102.d33653bf.js"><link rel="prefetch" href="/assets/js/103.e77d3b0e.js"><link rel="prefetch" href="/assets/js/104.dfa74f26.js"><link rel="prefetch" href="/assets/js/11.0f278d33.js"><link rel="prefetch" href="/assets/js/12.216dd2e9.js"><link rel="prefetch" href="/assets/js/13.639bf854.js"><link rel="prefetch" href="/assets/js/14.764d6819.js"><link rel="prefetch" href="/assets/js/15.416f065c.js"><link rel="prefetch" href="/assets/js/16.731aef97.js"><link rel="prefetch" href="/assets/js/17.8777cf4f.js"><link rel="prefetch" href="/assets/js/18.1c70eb8d.js"><link rel="prefetch" href="/assets/js/19.57063db6.js"><link rel="prefetch" href="/assets/js/20.fb6b405f.js"><link rel="prefetch" href="/assets/js/21.3aabd4f0.js"><link rel="prefetch" href="/assets/js/22.8af1b686.js"><link rel="prefetch" href="/assets/js/23.d4f63279.js"><link rel="prefetch" href="/assets/js/24.8689a0f6.js"><link rel="prefetch" href="/assets/js/25.5d33b161.js"><link rel="prefetch" href="/assets/js/26.36f181d5.js"><link rel="prefetch" href="/assets/js/27.0c2b0fe0.js"><link rel="prefetch" href="/assets/js/28.a4c29e70.js"><link rel="prefetch" href="/assets/js/29.28889e66.js"><link rel="prefetch" href="/assets/js/30.99fbc28d.js"><link rel="prefetch" href="/assets/js/31.71bd252c.js"><link rel="prefetch" href="/assets/js/32.babbae60.js"><link rel="prefetch" href="/assets/js/33.f304d766.js"><link rel="prefetch" href="/assets/js/34.a5f5cdb6.js"><link rel="prefetch" href="/assets/js/35.4a92e42e.js"><link rel="prefetch" href="/assets/js/36.1abb7548.js"><link rel="prefetch" href="/assets/js/37.d4be2d5f.js"><link rel="prefetch" href="/assets/js/38.801ba641.js"><link rel="prefetch" href="/assets/js/39.24898b78.js"><link rel="prefetch" href="/assets/js/4.f3bca92e.js"><link rel="prefetch" href="/assets/js/40.d8a62654.js"><link rel="prefetch" href="/assets/js/41.860e2ab2.js"><link rel="prefetch" href="/assets/js/42.a82ea0f3.js"><link rel="prefetch" href="/assets/js/43.ae1890e7.js"><link rel="prefetch" href="/assets/js/44.b3e68dd5.js"><link rel="prefetch" href="/assets/js/45.596c7e2d.js"><link rel="prefetch" href="/assets/js/46.1b43a550.js"><link rel="prefetch" href="/assets/js/47.3ea41d21.js"><link rel="prefetch" href="/assets/js/48.5e900732.js"><link rel="prefetch" href="/assets/js/49.4f602463.js"><link rel="prefetch" href="/assets/js/5.c349b01b.js"><link rel="prefetch" href="/assets/js/50.670490fe.js"><link rel="prefetch" href="/assets/js/51.9fbb8caa.js"><link rel="prefetch" href="/assets/js/52.840321e4.js"><link rel="prefetch" href="/assets/js/53.e1a43474.js"><link rel="prefetch" href="/assets/js/54.c85ee401.js"><link rel="prefetch" href="/assets/js/55.f43ce3dd.js"><link rel="prefetch" href="/assets/js/56.bca263ff.js"><link rel="prefetch" href="/assets/js/57.39e101c8.js"><link rel="prefetch" href="/assets/js/58.de218388.js"><link rel="prefetch" href="/assets/js/59.2a7ae851.js"><link rel="prefetch" href="/assets/js/6.d8e2a8a3.js"><link rel="prefetch" href="/assets/js/60.5e707e98.js"><link rel="prefetch" href="/assets/js/61.b59699d2.js"><link rel="prefetch" href="/assets/js/62.b70f089b.js"><link rel="prefetch" href="/assets/js/63.ff2c7f4a.js"><link rel="prefetch" href="/assets/js/64.b8476653.js"><link rel="prefetch" href="/assets/js/65.8d686fa0.js"><link rel="prefetch" href="/assets/js/66.77017295.js"><link rel="prefetch" href="/assets/js/67.cc07791a.js"><link rel="prefetch" href="/assets/js/68.018ee51d.js"><link rel="prefetch" href="/assets/js/69.d3ac3988.js"><link rel="prefetch" href="/assets/js/7.7705f7a3.js"><link rel="prefetch" href="/assets/js/70.1c6e027f.js"><link rel="prefetch" href="/assets/js/71.618dc2d8.js"><link rel="prefetch" href="/assets/js/72.f0270167.js"><link rel="prefetch" href="/assets/js/73.bcbe83c0.js"><link rel="prefetch" href="/assets/js/74.4a300285.js"><link rel="prefetch" href="/assets/js/75.eb546ca5.js"><link rel="prefetch" href="/assets/js/76.a30f65ea.js"><link rel="prefetch" href="/assets/js/77.e7856079.js"><link rel="prefetch" href="/assets/js/78.c698273d.js"><link rel="prefetch" href="/assets/js/79.f8dcbf54.js"><link rel="prefetch" href="/assets/js/8.307e5265.js"><link rel="prefetch" href="/assets/js/80.f8c8bde3.js"><link rel="prefetch" href="/assets/js/81.d6b26840.js"><link rel="prefetch" href="/assets/js/82.8fd49a1c.js"><link rel="prefetch" href="/assets/js/83.a4d68004.js"><link rel="prefetch" href="/assets/js/84.b99507f4.js"><link rel="prefetch" href="/assets/js/85.e81cb4c4.js"><link rel="prefetch" href="/assets/js/86.cd730ec9.js"><link rel="prefetch" href="/assets/js/87.55de5ab1.js"><link rel="prefetch" href="/assets/js/88.44c5d506.js"><link rel="prefetch" href="/assets/js/89.8e4a60a2.js"><link rel="prefetch" href="/assets/js/9.3c2622a5.js"><link rel="prefetch" href="/assets/js/90.5ebd6d3b.js"><link rel="prefetch" href="/assets/js/91.691dc180.js"><link rel="prefetch" href="/assets/js/92.5c5bada8.js"><link rel="prefetch" href="/assets/js/93.3445bdc8.js"><link rel="prefetch" href="/assets/js/94.bf07a218.js"><link rel="prefetch" href="/assets/js/95.42c1b6d3.js"><link rel="prefetch" href="/assets/js/96.56c01d96.js"><link rel="prefetch" href="/assets/js/97.752d5061.js"><link rel="prefetch" href="/assets/js/98.af513139.js"><link rel="prefetch" href="/assets/js/99.8a018af3.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d9c8cf8c.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="Young's blog" class="logo"> <span class="site-name can-hide">Young's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/Spring/" class="nav-link">Spring</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端文章1</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/8143cc480faf9a11/" class="nav-link">JavaScript</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/javascript/" class="nav-link">《JavaScript教程》</a></li><li class="dropdown-subitem"><a href="/note/js/" class="nav-link">《JavaScript高级程序设计》</a></li><li class="dropdown-subitem"><a href="/note/es6/" class="nav-link">《ES6 教程》</a></li><li class="dropdown-subitem"><a href="/note/vue/" class="nav-link">《Vue》</a></li><li class="dropdown-subitem"><a href="/note/react/" class="nav-link">《React》</a></li><li class="dropdown-subitem"><a href="/note/typescript-axios/" class="nav-link">《TypeScript 从零实现 axios》</a></li><li class="dropdown-subitem"><a href="/note/git/" class="nav-link">《Git》</a></li><li class="dropdown-subitem"><a href="/pages/51afd6/" class="nav-link">TypeScript</a></li><li class="dropdown-subitem"><a href="/pages/4643cd/" class="nav-link">JS设计模式总结</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="页面" class="dropdown-title"><a href="/ui/" class="link-title">页面</a> <span class="title" style="display:none;">页面</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/8309a5b876fc95e3/" class="nav-link">HTML</a></li><li class="dropdown-item"><!----> <a href="/pages/0a83b083bdf257cb/" class="nav-link">CSS</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/technology/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/9a7ee40fc232253e/" class="nav-link">技术文档</a></li><li class="dropdown-item"><!----> <a href="/pages/4c778760be26d8b3/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/pages/117708e0af7f0bd9/" class="nav-link">Nodejs</a></li><li class="dropdown-item"><!----> <a href="/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/pages/aea6571b7a8bae86/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/andanyang/vuepress-theme-vdoing" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/logo.png"> <div class="blogger-info"><h3>Young</h3> <span></span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/Spring/" class="nav-link">Spring</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端文章1</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/8143cc480faf9a11/" class="nav-link">JavaScript</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/javascript/" class="nav-link">《JavaScript教程》</a></li><li class="dropdown-subitem"><a href="/note/js/" class="nav-link">《JavaScript高级程序设计》</a></li><li class="dropdown-subitem"><a href="/note/es6/" class="nav-link">《ES6 教程》</a></li><li class="dropdown-subitem"><a href="/note/vue/" class="nav-link">《Vue》</a></li><li class="dropdown-subitem"><a href="/note/react/" class="nav-link">《React》</a></li><li class="dropdown-subitem"><a href="/note/typescript-axios/" class="nav-link">《TypeScript 从零实现 axios》</a></li><li class="dropdown-subitem"><a href="/note/git/" class="nav-link">《Git》</a></li><li class="dropdown-subitem"><a href="/pages/51afd6/" class="nav-link">TypeScript</a></li><li class="dropdown-subitem"><a href="/pages/4643cd/" class="nav-link">JS设计模式总结</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="页面" class="dropdown-title"><a href="/ui/" class="link-title">页面</a> <span class="title" style="display:none;">页面</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/8309a5b876fc95e3/" class="nav-link">HTML</a></li><li class="dropdown-item"><!----> <a href="/pages/0a83b083bdf257cb/" class="nav-link">CSS</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/technology/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/9a7ee40fc232253e/" class="nav-link">技术文档</a></li><li class="dropdown-item"><!----> <a href="/pages/4c778760be26d8b3/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/pages/117708e0af7f0bd9/" class="nav-link">Nodejs</a></li><li class="dropdown-item"><!----> <a href="/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/pages/aea6571b7a8bae86/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/andanyang/vuepress-theme-vdoing" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/pages/bigdata-generality/" class="sidebar-link">大数据技术之大数据概论</a></li><li><a href="/pages/Hadoop-Concept-explanation/" class="sidebar-link">大数据技术之 Hadoop概念讲解</a></li><li><a href="/pages/Build-Hadoop-running-environment/" class="sidebar-link">大数据之Hadoop 运行环境搭建</a></li><li><a href="/pages/Hadoop-working-mechanism/" class="sidebar-link">Hadoop之HDFS详解以及工作机制介绍</a></li><li><a href="/pages/haddop-MapReduce/" class="sidebar-link">MapReduce编程框架</a></li><li><a href="/pages/5cb5f8/" class="sidebar-link">Hadoop 数据压缩</a></li><li><a href="/Hadoop/Yarn/" class="sidebar-link">大数据技术之 Hadoop（Yarn）</a></li><li><a href="/pages/c19893/" aria-current="page" class="active sidebar-link">Hadoop（生产调优手册）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/c19893/#_1-1-namenode-内存生产配置" class="sidebar-link">1.1 NameNode 内存生产配置</a></li><li class="sidebar-sub-header level2"><a href="/pages/c19893/#_1-2-namenode心跳并发配置" class="sidebar-link">1.2 NameNode心跳并发配置</a></li><li class="sidebar-sub-header level2"><a href="/pages/c19893/#_1-3-开启回收站配置" class="sidebar-link">1.3 开启回收站配置</a></li><li class="sidebar-sub-header level2"><a href="/pages/c19893/#_2-1-测试hdfs写性能" class="sidebar-link">2.1 测试HDFS写性能</a></li><li class="sidebar-sub-header level2"><a href="/pages/c19893/#_2-2-测试hdfs读性能" class="sidebar-link">2.2 测试HDFS读性能</a></li><li class="sidebar-sub-header level2"><a href="/pages/c19893/#_3-1-namenode多目录配置" class="sidebar-link">3.1 NameNode多目录配置</a></li><li class="sidebar-sub-header level2"><a href="/pages/c19893/#_3-2-datanode多目录配置" class="sidebar-link">3.2 DataNode多目录配置</a></li><li class="sidebar-sub-header level2"><a href="/pages/c19893/#_3-3-集群数据均衡之磁盘间数据均衡" class="sidebar-link">3.3 集群数据均衡之磁盘间数据均衡</a></li><li class="sidebar-sub-header level2"><a href="/pages/c19893/#_4-1-添加白名单" class="sidebar-link">4.1 添加白名单</a></li><li class="sidebar-sub-header level2"><a href="/pages/c19893/#_4-2-服役新服务器" class="sidebar-link">4.2 服役新服务器</a></li><li class="sidebar-sub-header level2"><a href="/pages/c19893/#_4-3-服务器间数据均衡" class="sidebar-link">4.3 服务器间数据均衡</a></li><li class="sidebar-sub-header level2"><a href="/pages/c19893/#_4-4-黑名单退役服务器" class="sidebar-link">4.4 黑名单退役服务器</a></li><li class="sidebar-sub-header level2"><a href="/pages/c19893/#_5-1-纠删码" class="sidebar-link">5.1 纠删码</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/c19893/#_5-1-1-纠删码原理" class="sidebar-link">5.1.1 纠删码原理</a></li><li class="sidebar-sub-header level3"><a href="/pages/c19893/#_5-1-2-纠删码案例实操" class="sidebar-link">5.1.2 纠删码案例实操</a></li></ul></li></ul></li><li><a href="/pages/4a90c0/" class="sidebar-link">hadoo3.x 在windows10下编译</a></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/categories/?category=Hadoop" title="分类" data-v-06225672>Hadoop</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/andanyoung" target="_blank" title="作者" class="beLink" data-v-06225672>andanyang</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2023-06-28</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">Hadoop（生产调优手册）<!----></h1>  <div class="theme-vdoing-content content__default"><h1 id="第-1-章-hdfs-核心参数"><a href="#第-1-章-hdfs-核心参数" class="header-anchor">#</a> 第 1 章 HDFS—核心参数</h1> <h2 id="_1-1-namenode-内存生产配置"><a href="#_1-1-namenode-内存生产配置" class="header-anchor">#</a> 1.1 NameNode 内存生产配置</h2> <ul><li>1）NameNode 内存计算</li></ul> <p>每个文件块大概占用 150byte，一台服务器 128G 内存为例，能存储多少文件块呢？</p> <p>128 * 1024 * 1024 * 1024 / 150Byte ≈ 9.1 亿</p> <p>G MB KB Byte</p> <ul><li>2）Hadoop2.x 系列，配置 NameNode 内存</li></ul> <p>NameNode 内存默认 2000m，如果服务器内存 4G，NameNode 内存可以配置 3g。在 hadoop-env.sh 文件中配置如下。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>HADOOP_NAMENODE_OPTS=-Xmx3072m
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>3）Hadoop3.x 系列，配置 NameNode 内存
<ul><li>（1）hadoop-env.sh 中描述 Hadoop 的内存是动态分配的</li></ul></li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code># The maximum amount of heap to use (Java -Xmx).  If no unit
# is provided, it will be converted to MB.  Daemons will
# prefer any Xmx setting in their respective _OPT variable.
# There is no default; the JVM will autoscale based upon machine
# memory size.
# export HADOOP_HEAPSIZE_MAX=

# The minimum amount of heap to use (Java -Xms).  If no unit
# is provided, it will be converted to MB.  Daemons will
# prefer any Xms setting in their respective _OPT variable.
# There is no default; the JVM will autoscale based upon machine
# memory size.
# export HADOOP_HEAPSIZE_MIN=
HADOOP_NAMENODE_OPTS=-Xmx102400m
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>（2）查看NameNode占用内存</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[atguigu@hadoop102 ~]$ jps
3088 NodeManager
2611 NameNode
3271 JobHistoryServer
2744 DataNode
3579 Jps
[atguigu@hadoop102 ~]$ jmap -heap 2611
Heap Configuration:
   MaxHeapSize              = 1031798784 (984.0MB)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>（3）查看DataNode占用内存</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[atguigu@hadoop102 ~]$ jmap -heap 2744
Heap Configuration:
   MaxHeapSize              = 1031798784 (984.0MB)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>查看发现hadoop102上的NameNode和DataNode占用内存都是自动分配的，且相等。不是很合理。</p> <p><strong>经验参考：</strong></p> <p><a href="https://docs.cloudera.com/documentation/enterprise/6/release-notes/topics/rg_hardware_requirements.html#concept_fzz_dq4_gbb%5D" target="_blank" rel="noopener noreferrer">https://docs.cloudera.com/documentation/enterprise/6/release-notes/topics/rg_hardware_requirements.html#concept_fzz_dq4_gbb<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><img src="/assets/img/wps3.9abaab15.jpg" alt="img"> <img src="/assets/img/wps4.0a8ab47b.jpg" alt="img"></p> <p>具体修改：hadoop-env.sh</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>export HDFS_NAMENODE_OPTS=&quot;-Dhadoop.security.logger=INFO,RFAS -Xmx1024m&quot;
export HDFS_DATANODE_OPTS=&quot;-Dhadoop.security.logger=ERROR,RFAS -Xmx1024m&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="_1-2-namenode心跳并发配置"><a href="#_1-2-namenode心跳并发配置" class="header-anchor">#</a> <strong>1.2</strong> <strong>NameNode心跳并发配置</strong></h2> <p><img src="/assets/img/image-20230629001658507.41f04211.png" alt="image-20230629001658507"></p> <p>1）hdfs-site.xml</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>The number of Namenode RPC server threads that listen to requests from clients. If dfs.namenode.servicerpc-address is not configured then Namenode RPC server threads listen to requests from all nodes.
NameNode有一个工作线程池，用来处理不同DataNode的并发心跳以及客户端并发的元数据操作。
对于大集群或者有大量客户端的集群来说，通常需要增大该参数。默认值是10。
&lt;property&gt;
    &lt;name&gt;dfs.namenode.handler.count&lt;/name&gt;
    &lt;value&gt;21&lt;/value&gt;
&lt;/property&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>企业经验：dfs.namenode.handler.count=<img src="data:image/jpeg;base64,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" alt="img">，比如集群规模（DataNode台数)为3台时，此参数设置为21。可通过简单的python代码计算该值，代码如下。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[atguigu@hadoop102 ~]$ sudo yum install -y python
[atguigu@hadoop102 ~]$ python
Python 2.7.5 (default, Apr 11 2018, 07:36:10) 
[GCC 4.8.5 20150623 (Red Hat 4.8.5-28)] on linux2
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&gt;&gt;&gt; import math
&gt;&gt;&gt; print int(20*math.log(3))
21
&gt;&gt;&gt; quit()
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="_1-3-开启回收站配置"><a href="#_1-3-开启回收站配置" class="header-anchor">#</a> <strong>1.3</strong> <strong>开启回收站配置</strong></h2> <p>开启回收站功能，可以将删除的文件在不超时的情况下，恢复原数据，起到防止误删除、备份等作用。</p> <p>1）回收站工作机制</p> <p><img src="/assets/img/image-20230629001844220.bb7decb7.png" alt="image-20230629001844220"></p> <p>2）开启回收站功能参数说明</p> <p>（1）默认值fs.trash.interval = 0，0表示禁用回收站；其他值表示设置文件的存活时间。</p> <p>（2）默认值fs.trash.checkpoint.interval = 0，检查回收站的间隔时间。如果该值为0，则该值设置和fs.trash.interval的参数值相等。</p> <p>（3）要求fs.trash.checkpoint.interval &lt;= fs.trash.interval。</p> <p>3）启用回收站</p> <p>修改core-site.xml，配置垃圾回收时间为1分钟。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;property&gt;
    &lt;name&gt;fs.trash.interval&lt;/name&gt;
    &lt;value&gt;1&lt;/value&gt;
&lt;/property&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>4）查看回收站</p> <p>回收站目录在HDFS集群中的路径：/user/atguigu/.Trash/….</p> <p><mark>5）注意：通过网页上直接删除的文件也不会走回收站。</mark></p> <p>6）通过程序删除的文件不会经过回收站，需要调用moveToTrash()才进入回收站</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Trash trash = New Trash(conf);
trash.moveToTrash(path);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>7）只有在命令行利用<code>hadoop fs -rm</code>命令删除的文件才会走回收站。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[atguigu@hadoop102 hadoop-3.1.3]$ hadoop fs -rm -r /user/atguigu/input
2021-07-14 16:13:42,643 INFO fs.TrashPolicyDefault: Moved: 'hdfs://hadoop102:9820/user/atguigu/input' to trash at: hdfs://hadoop102:9820/user/atguigu/.Trash/Current/user/atguigu/input
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>8）恢复回收站数据</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[atguigu@hadoop102 hadoop-3.1.3]$ hadoop fs -mv
/user/atguigu/.Trash/Current/user/atguigu/input    /user/atguigu/input
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h1 id="第2章-hdfs-集群压测"><a href="#第2章-hdfs-集群压测" class="header-anchor">#</a> 第2章 HDFS—集群压测</h1> <p>在企业中非常关心每天从Java后台拉取过来的数据，需要多久能上传到集群？消费者关心多久能从HDFS上拉取需要的数据？</p> <p>为了搞清楚HDFS的读写性能，生产环境上非常需要对集群进行压测。</p> <p><img src="/assets/img/image-20230629002725626.1d4dc5fa.png" alt="image-20230629002725626"></p> <p>HDFS的读写性能主要受<strong>网络和磁盘</strong>影响比较大。为了方便测试，将hadoop102、hadoop103、hadoop104虚拟机网络都设置为100mbps。</p> <p><img src="/assets/img/image-20230629002750512.88d04983.png" alt="image-20230629002750512"></p> <p>100Mbps单位是bit；10M/s单位是byte ; 1byte=8bit，100Mbps/8=12.5M/s。</p> <p>测试网速：来到hadoop102的/opt/module目录，创建一个</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[atguigu@hadoop102 software]$ python -m SimpleHTTPServer
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_2-1-测试hdfs写性能"><a href="#_2-1-测试hdfs写性能" class="header-anchor">#</a> <strong>2.1</strong> 测试HDFS写性能</h2> <p>0）写测试底层原理</p> <p><img src="/assets/img/image-20230629002845923.1df46307.png" alt="image-20230629002845923"></p> <p>1）测试内容：向HDFS集群写10个128M的文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[atguigu@hadoop102 mapreduce]$ hadoop jar /opt/module/hadoop-3.1.3/share/hadoop/mapreduce/hadoop-mapreduce-client-jobclient-3.1.3-tests.jar TestDFSIO -write -nrFiles 10 -fileSize 128MB

2021-02-09 10:43:16,853 INFO fs.TestDFSIO: ----- TestDFSIO ----- : write
2021-02-09 10:43:16,854 INFO fs.TestDFSIO:             Date &amp; time: Tue Feb 09 10:43:16 CST 2021
2021-02-09 10:43:16,854 INFO fs.TestDFSIO:         Number of files: 10
2021-02-09 10:43:16,854 INFO fs.TestDFSIO:  Total MBytes processed: 1280
2021-02-09 10:43:16,854 INFO fs.TestDFSIO:       Throughput mb/sec: 1.61
2021-02-09 10:43:16,854 INFO fs.TestDFSIO:  Average IO rate mb/sec: 1.9
2021-02-09 10:43:16,854 INFO fs.TestDFSIO:   IO rate std deviation: 0.76
2021-02-09 10:43:16,854 INFO fs.TestDFSIO:      Test exec time sec: 133.05
2021-02-09 10:43:16,854 INFO fs.TestDFSIO:
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><mark>注意：nrFiles n为生成mapTask的数量，生产环境一般可通过hadoop103:8088查看CPU核数，设置为（CPU核数 - 1)</mark></p> <ul><li><p>Number of files：生成mapTask数量，一般是集群中（CPU核数-1），我们测试虚拟机就按照实际的物理内存-1分配即可</p></li> <li><p>Total MBytes processed：单个map处理的文件大小</p></li> <li><p>Throughput mb/sec:单个mapTak的吞吐量；</p> <ul><li>计算方式：处理的总文件大小/每一个mapTask写数据的时间累加</li> <li>集群整体吞吐量：生成mapTask数量*单个mapTak的吞吐量</li></ul></li> <li><p>Average IO rate mb/sec: 平均mapTak的吞吐量</p> <ul><li>计算方式：每个mapTask处理文件大小/每一个mapTask写数据的时间全部相加除以task数量</li></ul></li> <li><p>IO rate std deviation:方差、反映各个mapTask处理的差值，越小越均衡</p></li></ul> <p>2）注意：如果测试过程中，出现异常</p> <p>（1）可以在yarn-site.xml中设置虚拟内存检测为false</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;!--是否启动一个线程检查每个任务正使用的虚拟内存量，如果任务超出分配值，则直接将其杀掉，默认是true --&gt;
&lt;property&gt;
     &lt;name&gt;yarn.nodemanager.vmem-check-enabled&lt;/name&gt;
     &lt;value&gt;false&lt;/value&gt;
&lt;/property&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>（2）分发配置并重启Yarn集群</p> <p>3）测试结果分析</p> <p>（1）由于副本1就在本地，所以该副本不参与测试</p> <p><img src="/assets/img/image-20230629003226189.0b00f4f1.png" alt="image-20230629003226189"></p> <p>一共参与测试的文件：10个文件 * 2个副本 = 20个</p> <p>压测后的速度：1.61</p> <p>实测速度：1.61M/s * 20个文件 ≈ 32M/s</p> <p>三台服务器的带宽：12.5 + 12.5 + 12.5 ≈ 30m/s</p> <p>所有网络资源都已经用满。</p> <p><strong>如果实测速度远远小于网络，并且实测速度不能满足工作需求，可以考虑采用固态硬盘或者增加磁盘个数。</strong></p> <p>（2）如果客户端不在集群节点，那就三个副本都参与计算</p> <p><img src="/assets/img/image-20230629003320851.2ecfd7b7.png" alt="image-20230629003320851"></p> <h2 id="_2-2-测试hdfs读性能"><a href="#_2-2-测试hdfs读性能" class="header-anchor">#</a> <strong>2.2</strong> 测试HDFS读性能</h2> <p>1）测试内容：读取HDFS集群10个128M的文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[atguigu@hadoop102 mapreduce]$ hadoop jar /opt/module/hadoop-3.1.3/share/hadoop/mapreduce/hadoop-mapreduce-client-jobclient-3.1.3-tests.jar TestDFSIO -read -nrFiles 10 -fileSize 128MB

2021-02-09 11:34:15,847 INFO fs.TestDFSIO: ----- TestDFSIO ----- : read
2021-02-09 11:34:15,847 INFO fs.TestDFSIO:             Date &amp; time: Tue Feb 09 11:34:15 CST 2021
2021-02-09 11:34:15,847 INFO fs.TestDFSIO:         Number of files: 10
2021-02-09 11:34:15,847 INFO fs.TestDFSIO:  Total MBytes processed: 1280
2021-02-09 11:34:15,848 INFO fs.TestDFSIO:       Throughput mb/sec: 200.28
2021-02-09 11:34:15,848 INFO fs.TestDFSIO:  Average IO rate mb/sec: 266.74
2021-02-09 11:34:15,848 INFO fs.TestDFSIO:   IO rate std deviation: 143.12
2021-02-09 11:34:15,848 INFO fs.TestDFSIO:      Test exec time sec: 20.83
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>2）删除测试生成数据</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[atguigu@hadoop102 mapreduce]$ hadoop jar /opt/module/hadoop-3.1.3/share/hadoop/mapreduce/hadoop-mapreduce-client-jobclient-3.1.3-tests.jar TestDFSIO -clean
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>3）测试结果分析：为什么读取文件速度大于网络带宽？由于目前只有三台服务器，且有三个副本，数据读取就近原则，相当于都是读取的本地磁盘数据，没有走网络。</p> <p><img src="/assets/img/image-20230629003411139.74af7749.png" alt="image-20230629003411139"></p> <h1 id="第3章-hdfs-多目录"><a href="#第3章-hdfs-多目录" class="header-anchor">#</a> 第3章 HDFS—多目录</h1> <h2 id="_3-1-namenode多目录配置"><a href="#_3-1-namenode多目录配置" class="header-anchor">#</a> 3.1 NameNode多目录配置</h2> <p>1）NameNode的本地目录可以配置成多个，<strong>且每个目录存放内容相同</strong>，增加了可靠性</p> <p><img src="/assets/img/image-20230629003534834.95d4497a.png" alt="image-20230629003534834"></p> <p>2）具体配置如下</p> <p>（1）在hdfs-site.xml文件中添加如下内容</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;property&gt;
     &lt;name&gt;dfs.namenode.name.dir&lt;/name&gt;
     &lt;value&gt;file://${hadoop.tmp.dir}/dfs/name1,file://${hadoop.tmp.dir}/dfs/name2&lt;/value&gt;
&lt;/property&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>注意：因为每台服务器节点的磁盘情况不同，所以这个配置配完之后，可以选择不分发</strong></p> <p>（2）停止集群，删除三台节点的data和logs中所有数据。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[atguigu@hadoop102 hadoop-3.1.3]$ rm -rf data/ logs/
[atguigu@hadoop103 hadoop-3.1.3]$ rm -rf data/ logs/
[atguigu@hadoop104 hadoop-3.1.3]$ rm -rf data/ logs/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>（3）格式化集群并启动。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[atguigu@hadoop102 hadoop-3.1.3]$ bin/hdfs namenode -format
[atguigu@hadoop102 hadoop-3.1.3]$ sbin/start-dfs.sh
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>3）查看结果</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[atguigu@hadoop102 dfs]$ ll
总用量 12
drwx------. 3 atguigu atguigu 4096 12月 11 08:03 data
drwxrwxr-x. 3 atguigu atguigu 4096 12月 11 08:03 name1
drwxrwxr-x. 3 atguigu atguigu 4096 12月 11 08:03 name2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>检查name1和name2里面的内容，发现一模一样。</strong></p> <h2 id="_3-2-datanode多目录配置"><a href="#_3-2-datanode多目录配置" class="header-anchor">#</a> 3.2 DataNode多目录配置</h2> <p>1）DataNode可以配置成多个目录，**每个目录存储的数据不一样（**数据不是副本）</p> <p><img src="/assets/img/image-20230629003732601.717046da.png" alt="image-20230629003732601"></p> <p>2）具体配置如下</p> <p>在hdfs-site.xml文件中添加如下内容</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;property&gt;
     &lt;name&gt;dfs.datanode.data.dir&lt;/name&gt;
     &lt;value&gt;file://${hadoop.tmp.dir}/dfs/data1,file://${hadoop.tmp.dir}/dfs/data2&lt;/value&gt;
&lt;/property&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>3）查看结果</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[atguigu@hadoop102 dfs]$ ll
总用量 12
drwx------. 3 atguigu atguigu 4096 4月   4 14:22 data1
drwx------. 3 atguigu atguigu 4096 4月   4 14:22 data2
drwxrwxr-x. 3 atguigu atguigu 4096 12月 11 08:03 name1
drwxrwxr-x. 3 atguigu atguigu 4096 12月 11 08:03 name2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>4）向集群上传一个文件，再次观察两个文件夹里面的内容发现不一致（一个有数一个没有）</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[atguigu@hadoop102 hadoop-3.1.3]$ hadoop fs -put wcinput/word.txt /
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_3-3-集群数据均衡之磁盘间数据均衡"><a href="#_3-3-集群数据均衡之磁盘间数据均衡" class="header-anchor">#</a> 3.3 集群数据均衡之磁盘间数据均衡</h2> <p>生产环境，由于硬盘空间不足，往往需要增加一块硬盘。刚加载的硬盘没有数据时，可以执行磁盘数据均衡命令。（Hadoop3.x新特性）</p> <blockquote><p>同一台主机</p></blockquote> <p><img src="/assets/img/image-20230629003850739.fe0d62e6.png" alt="image-20230629003850739"></p> <p>（1）生成均衡计划（<strong>我们只有一块磁盘，不会生成计划</strong>）</p> <p>（2）执行均衡计划</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>hdfs diskbalancer -execute hadoop103.plan.json
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>（3）查看当前均衡任务的执行情况</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>hdfs diskbalancer -query hadoop103
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>（4）取消均衡任务</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>hdfs diskbalancer -cancel hadoop103.plan.json
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h1 id="第4章-hdfs-集群扩容及缩容"><a href="#第4章-hdfs-集群扩容及缩容" class="header-anchor">#</a> 第4章 HDFS—集群扩容及缩容</h1> <h2 id="_4-1-添加白名单"><a href="#_4-1-添加白名单" class="header-anchor">#</a> 4.1 添加白名单</h2> <p>白名单：表示在白名单的主机IP地址可以，用来存储数据。</p> <p>企业中：配置白名单，可以尽量防止黑客恶意访问攻击。</p> <p><img src="/assets/img/image-20230630001204615.4be7115a.png" alt="image-20230630001204615"></p> <p>配置白名单步骤如下：</p> <ul><li><p>1）在NameNode节点的/opt/module/hadoop-3.1.3/etc/hadoop目录下分别创建whitelist 和blacklist文件</p> <ul><li><p>（1）创建白名单</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[atguigu@hadoop102 hadoop]$ vim whitelist
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>在whitelist中添加如下主机名称，假如集群正常工作的节点为102 103</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>hadoop102
hadoop103
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>（2）创建黑名单</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[atguigu@hadoop102 hadoop]$ touch blacklist
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>保持空的就可以</p></li></ul></li> <li><p>2）在hdfs-site.xml配置文件中增加dfs.hosts配置参数</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;!-- 白名单 --&gt;
&lt;property&gt;
     &lt;name&gt;dfs.hosts&lt;/name&gt;
     &lt;value&gt;/opt/module/hadoop-3.1.3/etc/hadoop/whitelist&lt;/value&gt;
&lt;/property&gt;

&lt;!-- 黑名单 --&gt;
&lt;property&gt;
     &lt;name&gt;dfs.hosts.exclude&lt;/name&gt;
     &lt;value&gt;/opt/module/hadoop-3.1.3/etc/hadoop/blacklist&lt;/value&gt;
&lt;/property&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li> <li><p>3）分发配置文件whitelist，hdfs-site.xml</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[atguigu@hadoop104 hadoop]$ xsync hdfs-site.xml whitelist
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>4）第一次添加白名单必须重启集群，不是第一次，只需要刷新NameNode节点即可</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[atguigu@hadoop102 hadoop-3.1.3]$ myhadoop.sh stop
[atguigu@hadoop102 hadoop-3.1.3]$ myhadoop.sh start
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>5）在web浏览器上查看DN，http://hadoop102:9870/dfshealth.html#tab-datanode</p> <p><img src="/assets/img/image-20230630001510911.1a622a83.png" alt="image-20230630001510911"></p></li> <li><p>6）在hadoop104上执行上传数据数据失败</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[atguigu@hadoop104 hadoop-3.1.3]$ hadoop fs -put NOTICE.txt /
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>7）二次修改白名单，增加hadoop104</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[atguigu@hadoop102 hadoop]$ vim whitelist
修改为如下内容
hadoop102
hadoop103
hadoop104
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p>8）刷新NameNode</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[atguigu@hadoop102 hadoop-3.1.3]$ hdfs dfsadmin -refreshNodes
Refresh nodes successful
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>9）在web浏览器上查看DN，http://hadoop102:9870/dfshealth.html#tab-datanode</p></li></ul> <p><img src="/assets/img/image-20230630001627630.3b616416.png" alt="image-20230630001627630"></p> <h2 id="_4-2-服役新服务器"><a href="#_4-2-服役新服务器" class="header-anchor">#</a> 4.2 服役新服务器</h2> <ul><li><p>1）需求</p> <p>随着公司业务的增长，数据量越来越大，原有的数据节点的容量已经不能满足存储数据的需求，需要在原有集群基础上动态添加新的数据节点。</p></li> <li><p>2）环境准备</p> <ul><li><p>（1）在hadoop100主机上再克隆一台hadoop105主机</p></li> <li><p>（2）修改IP地址和主机名称</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@hadoop105 ~]# vim /etc/sysconfig/network-scripts/ifcfg-ens33
[root@hadoop105 ~]# vim /etc/hostname
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>（3）拷贝hadoop102的/opt/module目录和/etc/profile.d/my_env.sh到hadoop105</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[atguigu@hadoop102 opt]$ scp -r module/* atguigu@hadoop105:/opt/module/

[atguigu@hadoop102 opt]$ sudo scp /etc/profile.d/my_env.sh root@hadoop105:/etc/profile.d/my_env.sh

[atguigu@hadoop105 hadoop-3.1.3]$ source /etc/profile
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p>（4）删除hadoop105上Hadoop的历史数据，data和log数据</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[atguigu@hadoop105 hadoop-3.1.3]$ rm -rf data/ logs/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>（5）配置hadoop102和hadoop103到hadoop105的ssh无密登录</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[atguigu@hadoop102 .ssh]$ ssh-copy-id hadoop105

[atguigu@hadoop103 .ssh]$ ssh-copy-id hadoop105
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li></ul></li> <li><p>3）服役新节点具体步骤</p> <ul><li>（1）直接启动DataNode，即可关联到集群</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>[atguigu@hadoop105 hadoop-3.1.3]$ hdfs --daemon start datanode
[atguigu@hadoop105 hadoop-3.1.3]$ yarn --daemon start nodemanager
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="/assets/img/image-20230630001941619.b75d0f81.png" alt="image-20230630001941619"></p></li> <li><p>4）在白名单中增加新服役的服务器</p> <ul><li><p>（1）在白名单whitelist中增加hadoop104、hadoop105，并重启集群</p> <div class="language- line-numbers-mode"><pre class="language-text"><code> [atguigu@hadoop102 hadoop]$ vim whitelist
 修改为如下内容
 hadoop102
 hadoop103
 hadoop104
 hadoop105
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li> <li><p>（2）分发</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[atguigu@hadoop102 hadoop]$ xsync whitelist
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>（3）刷新NameNode</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[atguigu@hadoop102 hadoop-3.1.3]$ hdfs dfsadmin -refreshNodes
Refresh nodes successful
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li></ul></li> <li><p>5）在hadoop105上上传文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[atguigu@hadoop105 hadoop-3.1.3]$ hadoop fs -put /opt/module/hadoop-3.1.3/LICENSE.txt /
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/assets/img/image-20230630002144148.91f5cffe.png" alt="image-20230630002144148"></p> <p>思考：如果数据不均衡（hadoop105数据少，其他节点数据多），怎么处理？</p></li></ul> <h2 id="_4-3-服务器间数据均衡"><a href="#_4-3-服务器间数据均衡" class="header-anchor">#</a> 4.3 服务器间数据均衡</h2> <ul><li>1）企业经验：</li></ul> <p>在企业开发中，如果经常在hadoop102和hadoop104上提交任务，且副本数为2，由于数据本地性原则，就会导致hadoop102和hadoop104数据过多，hadoop103存储的数据量小。</p> <p>另一种情况，就是新服役的服务器数据量比较少，需要执行集群均衡命令。</p> <p><img src="/assets/img/image-20230630002306206.57929a4a.png" alt="image-20230630002306206"></p> <ul><li><p>2）开启数据均衡命令：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[atguigu@hadoop105 hadoop-3.1.3]$ sbin/start-balancer.sh -threshold 10
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>对于参数10，代表的是集群中各个节点的磁盘空间利用率相差不超过10%，可根据实际情况进行调整</p></li> <li><p>3）停止数据均衡命令：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[atguigu@hadoop105 hadoop-3.1.3]$ sbin/stop-balancer.sh
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p>注意：由于HDFS需要启动单独的Rebalance Server来执行Rebalance操作，<a href="http://xn--NameNodestart-balancer-sy68a2bx05ag98dux2afg9ay6af924fm2hzl3e.sh" target="_blank" rel="noopener noreferrer">所以尽量不要在NameNode上执行start-balancer.sh<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，而是找一台比较空闲的机器。</p></blockquote> <h2 id="_4-4-黑名单退役服务器"><a href="#_4-4-黑名单退役服务器" class="header-anchor">#</a> 4.4 黑名单退役服务器</h2> <p>黑名单：表示在黑名单的主机IP地址不可以，用来存储数据。</p> <p>企业中：配置黑名单，用来退役服务器。</p> <p><img src="/assets/img/image-20230630002451232.c663d81e.png" alt="image-20230630002451232"></p> <p>黑名单配置步骤如下：</p></li> <li><p>1）编辑/opt/module/hadoop-3.1.3/etc/hadoop目录下的blacklist文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[atguigu@hadoop102 hadoop] vim blacklist
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>添加如下主机名称（要退役的节点）</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>hadoop105
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p>注意：如果白名单中没有配置，需要在hdfs-site.xml配置文件中增加dfs.hosts配置参数</p></blockquote> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;!-- 黑名单 --&gt;
&lt;property&gt;
     &lt;name&gt;dfs.hosts.exclude&lt;/name&gt;
     &lt;value&gt;/opt/module/hadoop-3.1.3/etc/hadoop/blacklist&lt;/value&gt;
&lt;/property&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p>2）分发配置文件blacklist，hdfs-site.xml</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[atguigu@hadoop104 hadoop]$ xsync hdfs-site.xml blacklist
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>3）第一次添加黑名单必须重启集群，不是第一次，只需要刷新NameNode节点即可</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[atguigu@hadoop102 hadoop-3.1.3]$ hdfs dfsadmin -refreshNodes
Refresh nodes successful
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>4）检查Web浏览器，退役节点的状态为decommission in progress（退役中），说明数据节点正在复制块到其他节点</p> <p><img src="/assets/img/image-20230630002721564.c4edb77e.png" alt="image-20230630002721564"></p> <p><img src="data:image/png;base64,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" alt="image-20230630002726789"></p></li> <li><p>5）等待退役节点状态为decommissioned（所有块已经复制完成），停止该节点及节点资源管理器。注意：如果副本数是3，服役的节点小于等于3，是不能退役成功的，需要修改副本数后才能退役</p> <p><img src="data:image/png;base64,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" alt="image-20230630002746276"></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[atguigu@hadoop105 hadoop-3.1.3]$ hdfs --daemon stop datanode
stopping datanode
[atguigu@hadoop105 hadoop-3.1.3]$ yarn --daemon stop nodemanager
stopping nodemanager
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p>6）如果数据不均衡，可以用命令实现集群的再平衡</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[atguigu@hadoop102 hadoop-3.1.3]$ sbin/start-balancer.sh -threshold 10
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul> <h1 id="第5章-hdfs-存储优化"><a href="#第5章-hdfs-存储优化" class="header-anchor">#</a> 第5章 HDFS—存储优化</h1> <blockquote><p>注：演示纠删码和异构存储需要一共5台虚拟机。尽量拿另外一套集群。提前准备5台服务器的集群。</p></blockquote> <h2 id="_5-1-纠删码"><a href="#_5-1-纠删码" class="header-anchor">#</a> 5.1 纠删码</h2> <h3 id="_5-1-1-纠删码原理"><a href="#_5-1-1-纠删码原理" class="header-anchor">#</a> 5.1.1 纠删码原理</h3> <p>HDFS默认情况下，一个文件有3个副本，这样提高了数据的可靠性，但也带来了2倍的冗余开销。Hadoop3.x引入了纠删码，采用计算的方式，可以节省约50％左右的存储空间。</p> <p><img src="/assets/img/image-20230630002921587.6fe26520.png" alt="image-20230630002921587"></p> <ul><li><p>1）纠删码操作相关的命令</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[atguigu@hadoop102 hadoop-3.1.3]$ hdfs ec
Usage: bin/hdfs ec [COMMAND]
          [-listPolicies]
          [-addPolicies -policyFile &lt;file&gt;]
          [-getPolicy -path &lt;path&gt;]
          [-removePolicy -policy &lt;policy&gt;]
          [-setPolicy -path &lt;path&gt; [-policy &lt;policy&gt;] [-replicate]]
          [-unsetPolicy -path &lt;path&gt;]
          [-listCodecs]
          [-enablePolicy -policy &lt;policy&gt;]
          [-disablePolicy -policy &lt;policy&gt;]
          [-help &lt;command-name&gt;].
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div></li> <li><p>2）查看当前支持的纠删码策略</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[atguigu@hadoop102 hadoop-3.1.3] hdfs ec -listPolicies

Erasure Coding Policies:
ErasureCodingPolicy=[Name=RS-10-4-1024k, Schema=[ECSchema=[Codec=rs, numDataUnits=10, numParityUnits=4]], CellSize=1048576, Id=5], State=DISABLED

ErasureCodingPolicy=[Name=RS-3-2-1024k, Schema=[ECSchema=[Codec=rs, numDataUnits=3, numParityUnits=2]], CellSize=1048576, Id=2], State=DISABLED

ErasureCodingPolicy=[Name=RS-6-3-1024k, Schema=[ECSchema=[Codec=rs, numDataUnits=6, numParityUnits=3]], CellSize=1048576, Id=1], State=ENABLED
 
ErasureCodingPolicy=[Name=RS-LEGACY-6-3-1024k, Schema=[ECSchema=[Codec=rs-legacy, numDataUnits=6, numParityUnits=3]], CellSize=1048576, Id=3], State=DISABLED

ErasureCodingPolicy=[Name=XOR-2-1-1024k, Schema=[ECSchema=[Codec=xor, numDataUnits=2, numParityUnits=1]], CellSize=1048576, Id=4], State=DISABLED
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div></li> <li><p>3）纠删码策略解释:</p> <ul><li>RS-3-2-1024k：使用RS编码，每3个数据单元，生成2个校验单元，共5个单元，也就是说：这5个单元中，只要有任意的3个单元存在（不管是数据单元还是校验单元，只要总数=3），就可以得到原始数据。每个单元的大小是1024k=1024*1024=1048576。</li></ul> <p><img src="/assets/img/image-20230630003116899.9e2e2f15.png" alt="image-20230630003116899"></p> <ul><li><p>RS-10-4-1024k：使用RS编码，每10个数据单元（cell），生成4个校验单元，共14个单元，也就是说：这14个单元中，只要有任意的10个单元存在（不管是数据单元还是校验单元，只要总数=10），就可以得到原始数据。每个单元的大小是1024k=1024*1024=1048576。</p></li> <li><p>RS-6-3-1024k：使用RS编码，每6个数据单元，生成3个校验单元，共9个单元，也就是说：这9个单元中，只要有任意的6个单元存在（不管是数据单元还是校验单元，只要总数=6），就可以得到原始数据。每个单元的大小是1024k=1024*1024=1048576。</p></li> <li><p>RS-LEGACY-6-3-1024k：策略和上面的RS-6-3-1024k一样，只是编码的算法用的是rs-legacy。</p></li> <li><p>XOR-2-1-1024k：使用XOR编码（速度比RS编码快），每2个数据单元，生成1个校验单元，共3个单元，也就是说：这3个单元中，只要有任意的2个单元存在（不管是数据单元还是校验单元，只要总数= 2），就可以得到原始数据。每个单元的大小是1024k=1024*1024=1048576。</p></li></ul></li></ul> <h3 id="_5-1-2-纠删码案例实操"><a href="#_5-1-2-纠删码案例实操" class="header-anchor">#</a> 5.1.2 纠删码案例实操</h3> <div class="language- extra-class"><pre><code>![image-20230630003205173](../.vuepress/public/Hadoop/image-20230630003205173.png)
</code></pre></div><p>纠删码策略是给<strong>具体一个路径设置</strong>。所有往此路径下存储的文件，都会执行此策略。</p> <blockquote><p><strong>默认只开启对RS-6-3-1024k策略的支</strong>持，如要使用别的策略需要提前启用。</p></blockquote> <ul><li>1）需求：将/input目录设置为RS-3-2-1024k策略</li> <li>2）具体步骤</li></ul></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/andanyang/vuepress-theme-vdoing/edit/master/docs/Hadoop/0008.Hadoop（生产调优手册）.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2023/06/29, 16:33:33</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/Hadoop/Yarn/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">大数据技术之 Hadoop（Yarn）</div></a> <a href="/pages/4a90c0/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">hadoo3.x 在windows10下编译</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/Hadoop/Yarn/" class="prev">大数据技术之 Hadoop（Yarn）</a></span> <span class="next"><a href="/pages/4a90c0/">hadoo3.x 在windows10下编译</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/bi_report/"><div>
            BI和报表的区别，终于有人说清楚了！
            <!----></div></a> <span class="date">06-29</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/0b4a5d/"><div>
            MyBatis的插件开发
            <!----></div></a> <span class="date">06-29</span></dt></dl><dl><dd>03</dd> <dt><a href="/mysql/Master_slave_replication_delay/"><div>
            高频面试：如何解决MySQL主从复制延时问题
            <!----></div></a> <span class="date">06-20</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:1218853253@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/andanyang" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=755597173" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2019-2023
    <span>Young | <a href="https://github.com/andanyoung/young-blog/blob/master/LICENSE" target="_blank">MIT License</a> <br/> <a  href="https://beian.miit.gov.cn/" target="_blank">浙ICP备20002744号</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.b6693791.js" defer></script><script src="/assets/js/2.e72925f9.js" defer></script><script src="/assets/js/3.50ee34d2.js" defer></script>
  </body>
</html>
